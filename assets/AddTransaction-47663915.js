import{k as h,u as N,b as B,F as r,r as u,c1 as v,j as e,I as p,B as T,a3 as O,cB as Y,cA as q,cn as C,c3 as k}from"./index-16ff5701.js";import{d as _}from"./dayjs.min-72f12467.js";import{B as g}from"./BigDrawer-5db64386.js";import{A as y}from"./AddAccount-215a6d3d.js";import{D as E}from"./index-f03f7796.js";import{S as a}from"./Button-81cb4f36.js";import{T as M}from"./index-1ab3c210.js";let V=h().startOf("month").format("YYYY-MM-DD"),R=h().endOf("month").format("YYYY-MM-DD");const z=({preFieldValue:b,id:c,isSale:I,dueAmount:x})=>{const s=N(),{Title:S}=M,{list:i,loading:j}=B(t=>t.accounts),[o]=r.useForm();let[P,F]=u.useState(h());const[w,l]=u.useState(!1);u.useEffect(()=>{s(v())},[s]);const D=async t=>{var d;if(x&&(t==null?void 0:t.amount)>x){O.error("Amount cannot be greater then total return value!",{duration:3e3}),l(!1);return}try{const n={date:P,...t};((d=(await s(Y(n))).meta)==null?void 0:d.requestStatus)==="fulfilled"&&(l(!1),s(q({startdate:V,enddate:R})),s(I&&c?C(c):k(c))),o.resetFields(),l(!1)}catch{l(!1)}},A=t=>{l(!1)},f=(t,d)=>{const n=o.getFieldValue("type"),m=o.getFieldValue("relatedId");return!n&&m||n&&!m?Promise.reject("Select type and input related Id"):Promise.resolve()};return e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx(S,{level:4,className:"m-2 text-center",children:"Transaction"}),e.jsxs(r,{form:o,name:"basic",initialValues:{remember:!0,...b},layout:"vertical",className:"sm:mx-10",onFinish:D,onFinishFailed:A,autoComplete:"off",children:[e.jsx(r.Item,{style:{marginBottom:"10px"},label:"Date",required:!0,children:e.jsx(E,{defaultValue:_(),onChange:t=>F(t==null?void 0:t._d),label:"date",name:"date",className:"date-picker date-picker-transaction-create",rules:[{required:!0,message:"Please input date!"}]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsx("div",{className:"flex items-end mb-[10px]",children:e.jsx(r.Item,{className:"flex-grow  mb-0",name:"debitId",label:e.jsxs(e.Fragment,{children:["Debit Account",e.jsx(g,{title:"new debit account",children:e.jsx(y,{drawer:!0})})]}),rules:[{required:!0,message:"Please input debit account!"}],children:e.jsx(a,{loading:j,showSearch:!0,placeholder:"Select Debit ID",optionFilterProp:"children",children:i&&i.map(t=>e.jsx(a.Option,{value:t.id,children:t.name},t.id))})})}),e.jsx("div",{className:"flex items-end mb-[10px]",children:e.jsx(r.Item,{name:"creditId",label:e.jsxs(e.Fragment,{children:["Credit Account",e.jsx(g,{title:"new credit account",children:e.jsx(y,{drawer:!0})})]}),className:"flex-grow mb-0",rules:[{required:!0,message:"Please input debit account!"}],children:e.jsx(a,{loading:j,showSearch:!0,placeholder:"Select Credit ID",optionFilterProp:"children",children:i&&i.map(t=>e.jsx(a.Option,{value:t.id,children:t.name},t.id))})})}),e.jsx(r.Item,{style:{marginBottom:"10px"},label:"Amount",name:"amount",rules:[{required:!0,message:"Please input amount!"}],children:e.jsx(p,{type:"number"})}),e.jsx(r.Item,{style:{marginBottom:"10px"},label:"Particulars",name:"particulars",rules:[{required:!0,message:"Please input particulars!"}],children:e.jsx(p,{})})]}),e.jsx(r.Item,{style:{marginBottom:"10px"},label:"Invoice type - Id",name:"relatedId",rules:[{validator:f}],children:e.jsx(p,{addonBefore:e.jsx(r.Item,{name:"type",rules:[{validator:f}],noStyle:!0,children:e.jsxs(a,{allowClear:!0,size:"small",popupClassName:"min-w-[200px]",style:{width:150},placeholder:"Select type",optionFilterProp:"children",className:"transaction",children:[e.jsx(a.Option,{value:"sale",children:"Sale"}),e.jsx(a.Option,{value:"purchase",children:"Purchase"}),e.jsx(a.Option,{value:"sale_return",children:"Sale Return"}),e.jsx(a.Option,{value:"purchase_return",children:"Purchase Return"})]})}),placeholder:"Enter Invoice Id"})}),e.jsx(r.Item,{style:{marginBottom:"10px"},className:"flex justify-center mt-[24px]",children:e.jsx(T,{type:"primary",htmlType:"submit",shape:"round",loading:w,onClick:()=>l(!0),children:"Pay Now"})})]})]})})},U=z;export{U as A};

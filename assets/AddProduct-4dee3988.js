import{j as t,b as f,u as oe,F as l,r as m,bj as le,bf as se,bg as ne,bQ as ie,cr as de,bl as ce,bm as ue,bn as me,I as D,P as pe,B as he,cs as xe,be as ge,ct as be,b5 as fe}from"./index-16ff5701.js";import{R as je}from"./index-4f6b3efe.js";import{B as S}from"./BigDrawer-5db64386.js";import{A as ye}from"./addProductSubcategory-34015a86.js";import{A as we}from"./AddUoM-ec811117.js";import{A as Ce}from"./AddDiscount-f6dfe087.js";import{A as Se}from"./addProductBrand-7852dee3.js";import{A as Ie}from"./addVatTax-d5f3f099.js";import{S as u}from"./Button-81cb4f36.js";import{f as k}from"./TableComponent-f70e0475.js";import{I as Ae}from"./index-6d01e873.js";import{U as Pe}from"./index-0daf2765.js";const De=c=>{const{label:o,closable:n,onClose:p}=c,s=i=>{i.preventDefault(),i.stopPropagation()};return t.jsx(k,{onMouseDown:s,closable:n,onClose:p,style:{marginRight:3},children:o})},Be=({name:c,data:o,attributeValueHandler:n})=>{const s=o.filter(r=>r.status==="true").map(r=>({id:r.id,label:r.name,value:r.name})),i=r=>{const g=r.map(y=>s.find(j=>j.value===y).id);n(c,g)};return t.jsx(u,{mode:"multiple",tagRender:De,style:{width:"100%"},maxTagCount:0,options:s,maxTagPlaceholder:" Items Selected",placeholder:"Nothing Selected",onChange:i})},Fe=c=>{const{label:o,closable:n,onClose:p}=c,s=i=>{i.preventDefault(),i.stopPropagation()};return t.jsx(k,{onMouseDown:s,closable:n,onClose:p,style:{marginRight:3},children:o})},Ne=({data:c,attributes:o,attributesHandler:n})=>{const s=c.map(r=>({label:r.name,value:r.name,status:r.status})).filter(r=>r.status==="true"),i=r=>{n(r)};return t.jsx(u,{mode:"multiple",tagRender:Fe,style:{width:"100%"},maxTagCount:0,options:s,maxTagPlaceholder:`${o.length} items Selected`,placeholder:"Nothing Selected",onChange:i})},Ve=c=>{const{label:o,closable:n,onClose:p}=c,s=i=>{i.preventDefault(),i.stopPropagation()};return t.jsx(k,{onMouseDown:s,closable:n,onClose:p,style:{marginRight:3},children:o})},ke=({data:c,selectedColors:o,colorsHandler:n})=>{const s=c.filter(r=>r.status==="true").map(r=>({label:t.jsxs("span",{children:[t.jsx("span",{style:{backgroundColor:r.colorCode,width:"12px",height:"12px",display:"inline-block",marginRight:"6px"}}),r.name]}),value:r.id,id:r.id})),i=r=>{const g=r.map(y=>{const d=s.find(j=>j.id===y);return d==null?void 0:d.id});n(g)};return t.jsx(u,{mode:"multiple",tagRender:Ve,style:{width:"100%"},maxTagCount:0,options:s,defaultValue:o,maxTagPlaceholder:`${o==null?void 0:o.length} items Selected`,placeholder:"Nothing Selected",onChange:i})},Te={toolbar:[[{header:"1"},{header:"2"},{font:[]}],[{list:"ordered"},{list:"bullet"}],["bold","italic","underline"],["link","image"],[{color:[]},{background:[]}],["clean"]]},Oe=["header","font","size","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image","color","background"],Le=()=>{const c=f(e=>{var a;return(a=e.productSubCategories)==null?void 0:a.list}),o=f(e=>{var a;return(a=e.productBrands)==null?void 0:a.list}),n=f(e=>{var a;return(a=e.productAttribute)==null?void 0:a.list}),p=f(e=>{var a;return(a=e.discount)==null?void 0:a.list}),{list:s}=f(e=>e.colors),{list:i,loading:r}=f(e=>e.uom),{list:g,loading:y}=f(e=>e.vatTax),d=oe(),[j]=l.useForm();m.useEffect(()=>{d(le({page:1,count:100,status:!0})),d(se({page:1,count:100,status:!0})),d(ne({page:1,count:100,status:!0})),d(ie({count:50})),d(de()),d(ce()),d(ue()),d(me())},[d]);const[T,H]=m.useState([]),[K,w]=m.useState(!1),B=m.useRef(),[C,F]=m.useState(""),[O,v]=m.useState(null),[L,G]=m.useState(null),[N,R]=m.useState(!1),[I,z]=m.useState([]),[A,M]=m.useState({}),[U,_]=m.useState([]),[V,$]=m.useState([]),[q,Re]=m.useState(""),J=e=>{v(e)},Q=e=>{G(e)},W=e=>{R(e)},X=e=>{$(e)},E=e=>{const x=Object.values(e).reduce((b,h)=>[...b,...h],[]);_(x)},Y=e=>{const a=e.map(x=>n.find(h=>h.name===x));z(a)},Z=(e,a)=>{const b=Object.keys(A).find(h=>h===e);if(b){const h={...A,[b]:a};M(h),E(h)}else{const h={...A,[e]:a};M(h),E(h)}},ee=async e=>{w(!0);try{let a=new FormData;a.append("name",e.name),a.append("sku",e.sku),V.length>0&&a.append("colors",V),U.length>0&&a.append("productAttributeValueId",U),T.forEach(b=>{a.append("images[]",b.originFileObj)}),O&&a.append("productSubCategoryId",O),L&&a.append("productBrandId",L),e!=null&&e.uomId&&a.append("uomId",e.uomId),e!=null&&e.uomValue&&a.append("uomValue",e.uomValue),e!=null&&e.productSalePrice&&a.append("productSalePrice",e.productSalePrice),e!=null&&e.reorderQuantity&&a.append("reorderQuantity",e.reorderQuantity),N&&a.append("description",N),e.productVat&&a.append("productVatId",e.productVat),e.discountId&&a.append("discountId",parseInt(e.discountId)),q&&a.append("shippingChargeComment",q),(await d(xe(a))).payload.message==="success"&&(j.resetFields(),$([]),R(""),d(ge({status:"true",page:1,count:10}))),w(!1)}catch{w(!1)}},te=()=>{w(!1)},ae=({fileList:e})=>{H(e)},re=async e=>{F("loading"),B.current&&clearTimeout(B.current),e.target.value!==""?B.current=setTimeout(async()=>{const a=be({query:"sku",key:e.target.value});try{const{data:x}=await fe.get(`product?${a}`);x&&F(x.status)}catch{}},500):F("")};let P={};return C==="true"?P={validateStatus:"error",help:"Sku already exists"}:C==="false"?P={validateStatus:"success",help:"Sku available"}:C==="loading"&&(P={validateStatus:"validating",help:"Validating Sku..."}),t.jsx(t.Fragment,{children:t.jsxs(l,{form:j,name:"basic",layout:"vertical",className:"sm:mx-10",initialValues:{remember:!0},onFinish:ee,onFinishFailed:te,autoComplete:"off",children:[t.jsx(l.Item,{style:{marginBottom:"15px"},label:"Name",name:"name",rules:[{required:!0,message:"Please input Product name!"}],children:t.jsx(D,{})}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[t.jsx(l.Item,{style:{marginBottom:"15px"},name:"productSubCategoryId",className:"w-full sm:w-1/2",label:t.jsxs(t.Fragment,{children:["Subcategory",t.jsx(S,{title:"Sub Category",children:t.jsx(ye,{drawer:!0})})]}),children:t.jsx(u,{name:"productSubCategoryId",loading:!c,showSearch:!0,placeholder:"Select Subcategory",optionFilterProp:"children",filterOption:(e,a)=>a.children.includes(e),filterSort:(e,a)=>e.children.toLowerCase().localeCompare(a.children.toLowerCase()),onChange:J,children:c&&c.map(e=>t.jsx(u.Option,{value:e.id,children:e.name},e.id))})}),t.jsx(l.Item,{style:{marginBottom:"15px"},name:"productBrandId",className:"w-full sm:w-1/2",label:t.jsxs(t.Fragment,{children:["Brand",t.jsx(S,{title:"new Brand",children:t.jsx(Se,{drawer:!0})})]}),children:t.jsx(u,{name:"productBrandId",loading:!o,showSearch:!0,placeholder:"Select Brand",optionFilterProp:"children",filterOption:(e,a)=>a.children.includes(e),filterSort:(e,a)=>e.children.toLowerCase().localeCompare(a.children.toLowerCase()),onChange:Q,children:o&&o.map(e=>t.jsx(u.Option,{value:e.id,children:e.name},e.id))})})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[t.jsx(l.Item,{style:{marginBottom:"15px"},name:"uomId",className:"w-full sm:w-1/2",label:t.jsxs(t.Fragment,{children:["UoM",t.jsx(S,{title:"UoM",children:t.jsx(we,{})})]}),children:t.jsx(u,{name:"uomId",loading:r,showSearch:!0,placeholder:"Select UoM ",optionFilterProp:"children",filterOption:(e,a)=>a.children.includes(e),filterSort:(e,a)=>e.children.toLowerCase().localeCompare(a.children.toLowerCase()),children:i&&i.map(e=>t.jsx(u.Option,{value:e==null?void 0:e.id,children:e==null?void 0:e.name},e))})}),t.jsx(l.Item,{style:{marginBottom:"15px"},label:"UoM Value",name:"uomValue",className:"w-full sm:w-1/2",children:t.jsx(D,{type:"number"})})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[t.jsx(l.Item,{style:{marginBottom:"15px"},label:"Sale Price",className:"w-full sm:w-1/2",name:"productSalePrice",children:t.jsx(D,{type:"number"})}),t.jsx(l.Item,{style:{marginBottom:"15px"},label:"Reorder Quantity",className:"w-full sm:w-1/2",name:"reorderQuantity",children:t.jsx(Ae,{size:"small"})})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[t.jsx(l.Item,{style:{marginBottom:"15px"},label:"SKU No",name:"sku",className:"w-full sm:w-1/2",hasFeedback:!0,required:!0,...P,rules:[{validator:()=>new Promise((e,a)=>{C==="true"?a("This Sku already in use!"):C==="false"?e():a("Please enter the Sku!")})}],children:t.jsx(D,{onChange:re})}),(s==null?void 0:s.length)&&t.jsx(l.Item,{style:{marginBottom:"15px"},label:"Colors",className:"w-full sm:w-1/2",children:t.jsx(ke,{data:s,selectedColors:V,colorsHandler:X})})]}),n!=null&&n.length?t.jsx(l.Item,{style:{marginBottom:"15px"},label:"Attributes",children:t.jsx(Ne,{data:n,attributes:I,attributesHandler:Y})}):t.jsx(l.Item,{style:{marginBottom:"15px"},label:"Attributes",children:t.jsx(u,{})}),I==null?void 0:I.map(e=>t.jsx(l.Item,{style:{marginBottom:"15px"},label:e.name,name:e.name.toLowerCase(),children:t.jsx(Be,{name:e.name,data:e.productAttributeValue,attributeValueHandler:Z,attributeValue:A})},e.id)),t.jsx("div",{className:"flex gap-3",children:t.jsx(l.Item,{label:"Images",valuePropName:"gallery_image",className:"w-full",tooltip:"First image will be used as product Thumbnail image. Maximum number of images is 9 and each image should be less than 2MB.",children:t.jsx(Pe,{listType:"picture-card",beforeUpload:()=>!1,name:"image",fileList:T,maxCount:9,multiple:!0,onChange:ae,accept:"image/png, image/jpg, image/jpeg",children:t.jsxs("div",{children:[t.jsx(pe,{}),t.jsx("div",{style:{marginTop:8},children:"Upload"})]})})})}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[t.jsx(l.Item,{style:{marginBottom:"15px"},label:t.jsxs(t.Fragment,{children:["Discount",t.jsx(S,{title:"Discount",children:t.jsx(Ce,{})})]}),className:"w-full sm:w-1/2",name:"discountId",children:t.jsx(u,{name:"discountId",loading:!o,showSearch:!0,placeholder:"Select discount",optionFilterProp:"children",filterOption:(e,a)=>a.children.includes(e),filterSort:(e,a)=>e.children.toLowerCase().localeCompare(a.children.toLowerCase()),onChange:Q,allowClear:!0,children:p&&p.map(e=>t.jsx(u.Option,{value:e.id,children:`${e.type=="percentage"?`${e.value}%`:`Flat ${e.value}`}`},e.id))})}),g&&t.jsx(l.Item,{style:{marginBottom:"15px"},label:t.jsxs(t.Fragment,{children:["Vat/Tax",t.jsx(S,{title:"Vat/Tax",children:t.jsx(Ie,{})})]}),className:"w-full sm:w-1/2",name:"productVat",children:t.jsx(u,{allowClear:!0,placeholder:"Select Vat/Tax type",loading:y,children:g==null?void 0:g.map(e=>t.jsxs(u.Option,{value:e.id,children:[e.title,t.jsxs("span",{className:"italic",children:["@",e.percentage,"%"]})]},e.id))})})]}),t.jsx(l.Item,{style:{marginBottom:"25px"},label:"Product Description ",children:t.jsx(je,{value:N,onChange:W,modules:Te,formats:Oe})}),t.jsx(l.Item,{style:{marginBottom:"15px"},className:"flex justify-center mt-[24px]",children:t.jsx(he,{type:"primary",htmlType:"submit",shape:"round",loading:K,children:"Create Product"})})]})})},Je=Le;export{Je as A,ke as C,Oe as a,Te as t};

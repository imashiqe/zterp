import{b as I,u as y,q as z,k as j,j as e,r as p,ca as U,L as c,bh as V,o as R,cb as G,cc as H,cd as O,ce as w,F as x,a5 as K,a0 as S,a1 as D,I as g,B as $,cf as W,C as _,cg as J,a3 as Q,x as X,y as b}from"./index-16ff5701.js";import{T as Z,c as N,L as ee,P as C}from"./AdminLayout-ac80ae52.js";import{a as v}from"./Button-81cb4f36.js";import{C as f,a as te,d as A,f as ae,U as se,T as re}from"./TableComponent-f70e0475.js";import{R as oe}from"./ReportTable-1374d75d.js";import{i as ne}from"./invoiceGenerator-91e8874d.js";import{n as le}from"./numberToWords-4c291141.js";import{u as F}from"./useCurrency-ff395f2c.js";import{L as P}from"./List-ddf690f6.js";import{d as de}from"./detailSale-a5103176.js";import{C as ie}from"./CommonDelete-6a643bdc.js";import{E as me}from"./EditOutlined-f754bc7b.js";import{V as ce}from"./ViewBtn-eedc84ae.js";import{C as ue}from"./CreateDrawer-33537b52.js";import{A as L}from"./AddCustomer-1220d5e7.js";import{T as E}from"./index-1ab3c210.js";import{A as xe}from"./index-1b45a375.js";import"./index-8b1cef28.js";import"./useForceUpdate-5b1eefe7.js";import"./jspdf.es.min-3ec80e90.js";import"./index-6d01e873.js";import"./AddTransaction-47663915.js";import"./dayjs.min-72f12467.js";import"./BigDrawer-5db64386.js";import"./AddAccount-215a6d3d.js";import"./index-f03f7796.js";import"./index-2e4f1652.js";import"./InfoCircleFilled-829db91a.js";import"./fade-f955b557.js";import"./index-0daf2765.js";import"./DeleteOutlined-e1f8fe69.js";import"./index-4f6b3efe.js";import"./TagInput-4d878cae.js";import"./AddProduct-4dee3988.js";import"./addProductSubcategory-34015a86.js";import"./UploadMany-ab6f4635.js";import"./addProductCategory-004b5cd6.js";import"./AddUoM-ec811117.js";import"./AddDiscount-f6dfe087.js";import"./addProductBrand-7852dee3.js";import"./addVatTax-d5f3f099.js";import"./Collapse-d1408748.js";import"./index-5070a1ec.js";import"./ModalUi-03657474.js";function T({data:o,info:r,title:t,type:s,btnName:a}){const{currencySymbol:d}=F()||{},h=I(m=>{var k;return(k=m==null?void 0:m.setting)==null?void 0:k.data})||null;y(),le(Math.round((o==null?void 0:o.totalAmount)-(o==null?void 0:o.discount)));const i=z(d),n=[],u=[{label:"Total",value:`${i}${r!=null&&r.grandTotalAmount?r.grandTotalAmount:0}`},{label:"Paid",value:`${i}${r!=null&&r.grandTotalPaidAmount?r.grandTotalPaidAmount:0}`},{label:"Due",value:`${i}${r!=null&&r.grandDueAmount?r.grandDueAmount:0}`},{label:"Return",value:`${i}${r!=null&&r.grandTotalReturnAmount?r.grandTotalReturnAmount:0}`},{label:"Instant Paid Return",value:`${i}${r!=null&&r.grandInstantPaidReturnAmount?r.grandInstantPaidReturnAmount:0}`}],l=["Date","Id","Name","Email","Phone","Address","Total ","Paid","Due"],Y=o.map(m=>[j(m.createdAt).format("YYYY-MM-DD"),m.id,m.username,m.email,m.phone,m.address,`${i}${m.totalAmount?m.totalAmount:0}`,`${i}${m.totalPaidAmount?m.totalPaidAmount:0}`,`${i}${m.totalReturnAmount?m.totalReturnAmount:0}`]),B=[],M=[{value:`Report Date: ${j().format("YYYY-MM-DD")}`,style:{bold:!0,fontSize:12}}],q={jsPDF:{},tableFontSize:10,infoTopFontSize:8,bottomRightFontSize:12,bottomLeftFontSize:8,footerFontSize:10};return e.jsx("div",{className:"flex gap-2",children:e.jsx(v,{className:"bg-primary flex justify-center items-center px-4 py-2 text-white rounded",onClick:()=>ne(s,{title:t,TopRightInfo:M,companyInfo:h,customerInfo:B,bottomLeftContent:n,bottomRightContent:u,tableBody:Y,tableHead:l,settings:q}),children:a})})}function pe(){const o=y(),[r,t]=p.useState(!1),{list:s,loading:a,info:d}=I(n=>n.customers),h=[{id:1,title:"ID",dataIndex:"id",key:"id",render:n=>e.jsx(c,{to:`/admin/customer/${n}`,children:n})},{id:2,title:"username",dataIndex:"username",key:"name",render:(n,{id:u})=>e.jsx(c,{to:`/admin/customer/${u}`,children:n})},{id:3,title:"Email",dataIndex:"email",key:"email"},{id:3,title:"Phone",dataIndex:"phone",key:"phone"},{id:4,title:"Address",dataIndex:"address",key:"address",responsive:["md"]}],i=[{id:1,title:"Date",dataIndex:"createdAt",key:"createdAt",renderCsv:n=>j(n).format("DD-MM-YYYY")},{id:1,title:"ID",dataIndex:"id",key:"id",renderCsv:n=>n},{id:2,title:"username",dataIndex:"username",key:"name",renderCsv:n=>n},{id:3,title:"Email",dataIndex:"email",key:"email"},{id:3,title:"Phone",dataIndex:"phone",key:"phone"},{id:4,title:"Address",dataIndex:"address",key:"address",responsive:["md"]},{id:4,title:"Total",dataIndex:"totalAmount",key:"totalAmount",responsive:["md"]},{id:4,title:"Paid",dataIndex:"totalPaidAmount",key:"totalPaidAmount",responsive:["md"]},{id:4,title:"Due",dataIndex:"dueAmount",key:"dueAmount",responsive:["md"]},{id:4,title:"Return",dataIndex:"totalReturnAmount",key:"totalReturnAmount",responsive:["md"]}];return p.useEffect(()=>{o(U())},[o]),e.jsx("div",{className:"card card-custom mt-3 ",children:e.jsx("div",{className:"card-body",children:e.jsxs(f,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"Customer Report",children:[e.jsxs("div",{className:"flex justify-between py-5 items-start ",children:[e.jsx("div",{children:e.jsx(v,{onClick:()=>t(!0),className:"bg-green-500 text-white",children:"Generate Report"})}),e.jsxs("div",{className:"flex gap-2 items-center ",children:[!a&&s?e.jsx(T,{data:s,info:d,title:"Customer Report",type:"print",btnName:"Print"}):e.jsx("div",{children:e.jsx(v,{loading:a||!s,className:"bg-primary text-white",children:"Print"})}),!a&&s?e.jsx(T,{data:s,info:d,title:"Customer Report",type:"download",btnName:"Export PDF"}):e.jsx("div",{children:e.jsx(v,{loading:a||!s,className:"bg-primary text-white",children:"Export PDF"})}),e.jsx("div",{children:e.jsx(te,{list:s,columns:i,title:"Customer Report",className:"bg-primary",btnName:"Export CSV"})})]})]}),r&&e.jsx(oe,{list:s,columns:h,loading:a})]})})})}function he({list:o,linkTo:r}){const t=[{id:1,title:"Invoice",dataIndex:"id",key:"id",render:(a,{id:d})=>e.jsx(c,{to:`/admin/sale/${d}`,children:d}),renderCsv:a=>a},{id:2,title:"Date",dataIndex:"date",key:"date",render:a=>j(a).format("ll"),renderCsv:a=>j(a).format("ll")},{id:4,title:"Total Amount",dataIndex:"totalAmount",key:"totalAmount",render:a=>Number(a).toFixed(2),renderCsv:a=>Number(a).toFixed(2)},{id:7,title:"Paid",dataIndex:"paidAmount",key:"paidAmount",render:a=>Number(a).toFixed(2),responsive:["md"],renderCsv:a=>Number(a).toFixed(2)},{id:6,title:"Due",dataIndex:"dueAmount",key:"dueAmount",render:a=>Number(a).toFixed(2),renderCsv:a=>Number(a).toFixed(2),responsive:["md"]},{id:5,title:"Due date",dataIndex:"dueDate",key:"discount",render:a=>a?e.jsxs("div",{className:"flex gap-1 items-center",children:[j(a).format("ll"),de(a)&&e.jsx(ae,{className:"text-xs",color:"red",children:"Overdue"})]}):null,renderCsv:a=>Number(a).toFixed(2)},{id:8,title:"Profit",dataIndex:"profit",key:"profit",render:a=>Number(a).toFixed(2),renderCsv:a=>Number(a).toFixed(2),responsive:["md"]},{id:9,title:"Sale Person",dataIndex:"user",key:"user",render:a=>e.jsx(c,{to:`/admin/hr/staffs/${a==null?void 0:a.id}`,children:a==null?void 0:a.username}),renderCsv:a=>a==null?void 0:a.username,responsive:["md"]}],s=a=>a.map(d=>({...d,key:d.id}));return e.jsx("div",{className:"m-2",children:e.jsx(A,{scroll:{x:!0},loading:!o,columns:t,data:o?s(o):[]})})}const je=({list:o})=>{const r=[{title:"ID",dataIndex:"id",key:"id"},{title:"Date",dataIndex:"date",key:"date",render:s=>j(s).format("ll")},{title:"Total Amount",dataIndex:"totalAmount",key:"totalAmount"},{title:"Tax",dataIndex:"tax",key:"tax"},{title:"Note",dataIndex:"note",key:"note"},{title:"Sale Invoice No",dataIndex:"saleInvoiceId",key:"saleInvoiceId",render:s=>e.jsx(c,{to:`/admin/sale/${s}`,children:s})}],t=s=>s.map(a=>({...a,key:a.id}));return e.jsx("div",{className:"m-2",children:e.jsx(A,{scroll:{x:!0},columns:r,data:o?t(o):[]})})},be=({list:o})=>{const r=[{title:"ID",dataIndex:"id",key:"id",render:s=>e.jsx(c,{to:`/admin/transaction/${s}`,children:s})},{title:"Date",dataIndex:"date",key:"date",render:s=>j(s).format("ll")},{title:"Debit",dataIndex:"debit",key:"debit",render:s=>e.jsx(c,{to:`/admin/account/${s==null?void 0:s.id}`,children:s==null?void 0:s.name})},{title:"Credit",dataIndex:"credit",key:"credit",render:s=>e.jsx(c,{to:`/admin/account/${s==null?void 0:s.id}`,children:s==null?void 0:s.name})},{title:"Amount",dataIndex:"amount",key:"amount"},{title:"Type ",dataIndex:"type",key:"type"},{title:"Particulars",dataIndex:"particulars",key:"particulars",render:s=>e.jsx("div",{title:s,children:V(s,20)})}],t=s=>s.map(a=>({...a,key:a.id}));return e.jsx("div",{className:"m-2",children:e.jsx(A,{scroll:{x:!0},columns:r,data:o?t(o):[]})})},ye=()=>{const{id:o}=R();F();const r=y(),t=I(s=>s.customers.customer);return p.useEffect(()=>(r(G(o)),()=>{r(H())}),[o]),e.jsx(e.Fragment,{children:t?e.jsxs("div",{className:"flex gap-2 md:gap-4",children:[e.jsxs(f,{className:"w-2/3",bodyClass:"p-0",children:[e.jsx("div",{className:"flex justify-between mx-2 py-2 border-b items-center",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(c,{to:`/admin/customer/${t==null?void 0:t.id}/update`,state:{data:t},children:e.jsx(me,{className:"bg-primary text-white p-3 rounded"})}),e.jsx(ie,{permission:"delete-customer",deleteThunk:O,id:o,navigatePath:"/admin/customer",className:"p-3"})]})}),e.jsxs(Z,{className:"mt-4",children:[e.jsx(N,{label:e.jsxs("span",{children:["Invoice"," ",e.jsx("span",{className:"ml-2 rounded-full bg-slate-300 text-slate-700 px-1",children:t==null?void 0:t.totalSaleInvoice})]}),children:e.jsx(he,{list:t==null?void 0:t.saleInvoice,linkTo:"/admin/sale"})}),e.jsx(N,{label:e.jsxs("span",{children:["Return Invoice"," ",e.jsx("span",{className:"ml-2 rounded-full bg-slate-300 text-slate-700 px-1",children:t==null?void 0:t.totalReturnSaleInvoice})]}),children:e.jsx(je,{list:t==null?void 0:t.returnSaleInvoice})}),e.jsx(N,{label:"Transactions",children:e.jsx(be,{list:t==null?void 0:t.allTransaction})})]})]}),e.jsxs("div",{className:"w-1/3 flex flex-col gap-2 md:gap-4",children:[e.jsx(f,{title:"Customer Details",children:e.jsx(P,{labelClassName:"w-[30%]",list:[{label:"Name",value:t==null?void 0:t.username},{label:"Phone",value:t==null?void 0:t.phone},{label:"Email",value:t==null?void 0:t.email},{label:"Address",value:t==null?void 0:t.address}]})}),e.jsx(f,{children:e.jsx(P,{labelClassName:"w-[30%]",list:[{label:"Total Amount",value:t!=null&&t.totalAmount?Number(t.totalAmount).toFixed(2):0},{label:"Return Amount",value:e.jsx("div",{className:"before:content-['-'] relative before:absolute before:text-red-500 before:font-bold before:-left-3 before:top-0",children:t==null?void 0:t.totalReturnAmount})},{label:"Paid Amount",value:e.jsx("div",{className:"before:content-['-'] relative before:absolute before:text-red-500 before:font-bold before:-left-3 before:top-0",children:t==null?void 0:t.totalPaidAmount}),className:"border-b pb-1"},{label:"Due Amount",value:t==null?void 0:t.dueAmount}]})})]})]}):e.jsx(ee,{})})},ge=ye,fe=()=>{const o=y(),{list:r,total:t,loading:s}=I(n=>n.customers),[a,d]=p.useState({page:1,count:10,status:"true"}),h=[{id:1,title:"ID",dataIndex:"id",key:"id",render:n=>e.jsx(c,{to:`/admin/customer/${n}`,children:n}),renderCsv:n=>n},{id:2,title:"username",dataIndex:"username",key:"name",render:(n,{id:u})=>e.jsx(c,{to:`/admin/customer/${u}`,children:n}),renderCsv:n=>n},{id:3,title:"Email",dataIndex:"email",key:"email"},{id:3,title:"Phone",dataIndex:"phone",key:"phone"},{id:4,title:"Address",dataIndex:"address",key:"address",responsive:["md"]},{id:5,title:"Action",key:"Action",render:({id:n})=>e.jsx(ce,{path:`/admin/customer/${n}`}),csvOff:!0}],i=[{key:"status",label:"Status",type:"select",options:[{label:"Show",value:"true"},{label:"Hide",value:"false"}],className:"min-w-[85px] max-w-[150px]",popupClassName:"w-[100px]"}];return p.useEffect(()=>{o(w({page:1,count:10}))},[o]),p.useEffect(()=>{o(w(a))},[o,a]),e.jsx(f,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"Customers",extra:e.jsx(ue,{permission:"create-customer",title:"Create Customer",width:35,children:e.jsx(L,{})}),children:e.jsx(se,{permission:"readAll-customer",children:e.jsx(re,{columns:h,list:r,total:t,loading:s,title:"Customer List",setPageConfig:d,filters:i,isSearch:!0})})})},Ce=fe;function ve(){const{Title:o}=E,[r]=x.useForm(),{id:t}=R(),s=y(),[a,d]=p.useState(),h=K(),{data:i}=h.state,n=async u=>{await s(W({id:t,values:u})),d(!1)};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"",children:e.jsx(S,{className:"mr-top",children:e.jsxs(D,{xs:24,sm:24,md:12,lg:12,xl:14,className:"border rounded column-design",children:[e.jsx(o,{level:3,className:"m-4 text-center",children:"Edit Customer Form"}),e.jsxs(x,{initialValues:i,form:r,className:"m-6",name:"basic",labelCol:{span:5},wrapperCol:{span:16},onFinish:n,autoComplete:"off",children:[e.jsx(x.Item,{style:{marginBottom:"10px"},label:"User Name",name:"username",rules:[{required:!0,message:"Please input customer name!"}],children:e.jsx(g,{})}),e.jsx(x.Item,{style:{marginBottom:"10px"},label:"Phone",name:"phone",rules:[{required:!0,message:"Please input customer Phone!"}],children:e.jsx(g,{})}),e.jsx(x.Item,{style:{marginBottom:"10px"},label:"Address",name:"address",rules:[{required:!0,message:"Please input customer Address!"}],children:e.jsx(g,{})}),e.jsx(x.Item,{style:{marginBottom:"10px"},wrapperCol:{offset:5,span:16},children:e.jsx($,{onClick:()=>d(!0),block:!0,type:"primary",htmlType:"submit",shape:"round",loading:a,children:"Update Now"})})]})]})})})})})}const Ie=()=>{const o=y(),[r,t]=p.useState(!1),[s,a]=p.useState(!1),{Title:d}=E,h=async n=>{var u;try{const l=await o(J(n));l.payload.message==="success"?(localStorage.setItem("access-token",l==null?void 0:l.payload.data.token),localStorage.setItem("email",l==null?void 0:l.payload.data.email),localStorage.setItem("username",l==null?void 0:l.payload.data),localStorage.setItem("id",l==null?void 0:l.payload.data.id),localStorage.setItem("phone",l==null?void 0:l.payload.data.phone),localStorage.setItem("address",(u=l==null?void 0:l.payload.data)==null?void 0:u.address),localStorage.setItem("isLogged",!0),a(!0),setTimeout(()=>{window.location.href="/",a(!1),t(!1)},2e3)):(t(!1),a(!1))}catch{t(!1),a(!1)}},i=n=>{t(!1)};return e.jsx(e.Fragment,{children:e.jsx(S,{className:"card-row",children:e.jsx(D,{span:24,children:e.jsxs(_,{bordered:!1,className:"w-full max-w-[480px] border-solid border-2 mx-auto border-black-300 mt-[5rem]",children:[s&&e.jsx(xe,{message:"Login Success",description:"Redirecting to Homepage",type:"success",showIcon:!0}),e.jsx(d,{level:3,className:"mt-10 mb-10 text-center",children:"Login Now"}),e.jsxs(x,{name:"basic",labelCol:{span:6},wrapperCol:{span:16},onFinish:h,onFinishFailed:i,autoComplete:"off",children:[e.jsx(x.Item,{className:"mb-5",label:"Email",name:"email",rules:[{required:!0,message:"Please input your email!"}],children:e.jsx(g,{type:"email"})}),e.jsx(x.Item,{className:"mb-5",label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:e.jsx(g.Password,{})}),e.jsx(x.Item,{className:"flex justify-center",children:e.jsx($,{type:"primary",htmlType:"submit",loading:r,onClick:()=>t(!0),children:"Submit"})})]}),e.jsxs(d,{className:"mt-5 mb-5 text-center text-base",children:["Don't have an account?"," ",e.jsx(c,{to:"/customer/register",children:"Register Now"})]})]})})})})},Ne=Ie;function Ae(o){p.useEffect(()=>{localStorage.clear(),Q.success("Logged Out"),window.location.href="/customer/login"},[])}const ke=()=>e.jsx(e.Fragment,{children:e.jsx(L,{})}),we=ke;function yt(){return e.jsxs(X,{children:[e.jsx(b,{path:"/customer",exact:!0,element:e.jsx(C,{permission:"readAll-customer",children:e.jsx(Ce,{})})}),e.jsx(b,{path:"/customer-report",exact:!0,element:e.jsx(C,{permission:"readAll-customer",children:e.jsx(pe,{})})}),e.jsx(b,{path:"/customer/:id",element:e.jsx(C,{permission:"readSingle-customer",children:e.jsx(ge,{})})}),e.jsx(b,{path:"/customer/:id/update",element:e.jsx(C,{permission:"update-customer",children:e.jsx(ve,{})})}),e.jsx(b,{path:"/customer/register",element:e.jsx(we,{})}),e.jsx(b,{path:"/customer/login",element:e.jsx(Ne,{})}),e.jsx(b,{path:"/customer/logout",element:e.jsx(Ae,{})})]})}export{yt as default};

import{Q as We,T as Ke,aa as ve,aC as Xe,r as p,U as $e,z as le,bS as Ze,aL as Je,bT as et,aM as tt,a9 as st,bU as nt,al as rt,ac as at,bV as ke,u as Y,b as k,bW as Ne,j as e,L as z,k as w,q as oe,s as W,o as ie,bX as lt,bY as Pe,bZ as ot,bw as xe,b_ as it,b$ as ct,c0 as Ie,F as C,P as he,c1 as Fe,B as J,e as Te,be as dt,I as G,c2 as ut,b5 as mt,b6 as pt,b7 as xt,c3 as ce,C as ht,bh as ft,c4 as jt,c5 as bt,c6 as Ye,c7 as yt,bc as ne,x as gt,y as B}from"./index-16ff5701.js";import{S as vt,d as Nt,I as Pt,e as fe,L as Me,f as It,T as Ct,c as me,D as At,b as wt,P as _}from"./AdminLayout-ac80ae52.js";import{C as E,U as je,T as be,b as Re,d as ee,a as St,f as Dt}from"./TableComponent-f70e0475.js";import{V as de}from"./ViewBtn-eedc84ae.js";import{C as $t}from"./CreateDrawer-33537b52.js";import{A as kt}from"./AddPurchaseOrder-3a3b61c0.js";import{i as te}from"./invoiceGenerator-91e8874d.js";import{n as se}from"./numberToWords-4c291141.js";import{u as K}from"./useCurrency-ff395f2c.js";import{d as V}from"./dayjs.min-72f12467.js";import{D as U}from"./index-f03f7796.js";import{a as Q,S as L,s as Ft,t as Tt,M as Yt,b as Mt,r as Rt,v as Ot}from"./Button-81cb4f36.js";import{R as Et}from"./ReportTable-1374d75d.js";import{I as q}from"./index-6d01e873.js";import{B as zt}from"./BigDrawer-5db64386.js";import{A as Qt}from"./addSup-096a94aa.js";import{L as re}from"./List-ddf690f6.js";import{A as Lt}from"./AddTransaction-47663915.js";import{D as Bt}from"./index-0daf2765.js";import{R as _t}from"./index-4f6b3efe.js";import{C as Vt,T as Ce}from"./TagInput-4d878cae.js";import{t as qt,a as Ht}from"./AddProduct-4dee3988.js";import{C as Ae}from"./Collapse-d1408748.js";import{I as Ut}from"./InfoCircleFilled-829db91a.js";import{N as Gt,u as Wt}from"./useNotification-bca0f259.js";import{M as pe}from"./ModalUi-03657474.js";import{T as Kt}from"./index-1ab3c210.js";import{P as Xt}from"./index-8b1cef28.js";import{C as Zt}from"./CreateButton-6e9825f1.js";import{a as Jt,b as es,c as ts}from"./index-bad6c49c.js";import{a as X}from"./nFormetter-e5bcdc34.js";import"./EditOutlined-f754bc7b.js";import"./jspdf.es.min-3ec80e90.js";import"./UploadMany-ab6f4635.js";import"./AddAccount-215a6d3d.js";import"./useForceUpdate-5b1eefe7.js";import"./DeleteOutlined-e1f8fe69.js";import"./fade-f955b557.js";import"./addProductSubcategory-34015a86.js";import"./addProductCategory-004b5cd6.js";import"./AddUoM-ec811117.js";import"./AddDiscount-f6dfe087.js";import"./addProductBrand-7852dee3.js";import"./addVatTax-d5f3f099.js";import"./index-5070a1ec.js";const ss=t=>{const{componentCls:r,iconCls:a,boxShadow:s,colorText:n,colorSuccess:c,colorError:m,colorWarning:f,colorInfo:x,fontSizeLG:l,motionEaseInOutCirc:u,motionDurationSlow:d,marginXS:o,paddingXS:i,borderRadiusLG:j,zIndexPopup:v,contentPadding:y,contentBg:b}=t,S=`${r}-notice`,I=new ve("MessageMoveIn",{"0%":{padding:0,transform:"translateY(-100%)",opacity:0},"100%":{padding:i,transform:"translateY(0)",opacity:1}}),A=new ve("MessageMoveOut",{"0%":{maxHeight:t.height,padding:i,opacity:1},"100%":{maxHeight:0,padding:0,opacity:0}}),g={padding:i,textAlign:"center",[`${r}-custom-content > ${a}`]:{verticalAlign:"text-bottom",marginInlineEnd:o,fontSize:l},[`${S}-content`]:{display:"inline-block",padding:y,background:b,borderRadius:j,boxShadow:s,pointerEvents:"all"},[`${r}-success > ${a}`]:{color:c},[`${r}-error > ${a}`]:{color:m},[`${r}-warning > ${a}`]:{color:f},[`${r}-info > ${a},
      ${r}-loading > ${a}`]:{color:x}};return[{[r]:Object.assign(Object.assign({},Xe(t)),{color:n,position:"fixed",top:o,width:"100%",pointerEvents:"none",zIndex:v,[`${r}-move-up`]:{animationFillMode:"forwards"},[`
        ${r}-move-up-appear,
        ${r}-move-up-enter
      `]:{animationName:I,animationDuration:d,animationPlayState:"paused",animationTimingFunction:u},[`
        ${r}-move-up-appear${r}-move-up-appear-active,
        ${r}-move-up-enter${r}-move-up-enter-active
      `]:{animationPlayState:"running"},[`${r}-move-up-leave`]:{animationName:A,animationDuration:d,animationPlayState:"paused",animationTimingFunction:u},[`${r}-move-up-leave${r}-move-up-leave-active`]:{animationPlayState:"running"},"&-rtl":{direction:"rtl",span:{direction:"rtl"}}})},{[r]:{[S]:Object.assign({},g)}},{[`${r}-notice-pure-panel`]:Object.assign(Object.assign({},g),{padding:0,textAlign:"start"})}]},Oe=We("Message",t=>{const r=Ke(t,{height:150});return[ss(r)]},t=>({zIndexPopup:t.zIndexPopupBase+10,contentBg:t.colorBgElevated,contentPadding:`${(t.controlHeightLG-t.fontSize*t.lineHeight)/2}px ${t.paddingSM}px`}),{clientOnly:!0});var ns=globalThis&&globalThis.__rest||function(t,r){var a={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&r.indexOf(s)<0&&(a[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)r.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(a[s[n]]=t[s[n]]);return a};const rs={info:p.createElement(Ut,null),success:p.createElement(Ze,null),error:p.createElement(Je,null),warning:p.createElement(et,null),loading:p.createElement(tt,null)},Ee=t=>{let{prefixCls:r,type:a,icon:s,children:n}=t;return p.createElement("div",{className:le(`${r}-custom-content`,`${r}-${a}`)},s||rs[a],p.createElement("span",null,n))},as=t=>{const{prefixCls:r,className:a,type:s,icon:n,content:c}=t,m=ns(t,["prefixCls","className","type","icon","content"]),{getPrefixCls:f}=p.useContext($e),x=r||f("message"),[,l]=Oe(x);return p.createElement(Gt,Object.assign({},m,{prefixCls:x,className:le(a,l,`${x}-notice-pure-panel`),eventKey:"pure",duration:null,content:p.createElement(Ee,{prefixCls:x,type:s,icon:n},c)}))},ls=as;function os(t,r){return{motionName:r??`${t}-move-up`}}function ye(t){let r;const a=new Promise(n=>{r=t(()=>{n(!0)})}),s=()=>{r==null||r()};return s.then=(n,c)=>a.then(n,c),s.promise=a,s}var is=globalThis&&globalThis.__rest||function(t,r){var a={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&r.indexOf(s)<0&&(a[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)r.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(a[s[n]]=t[s[n]]);return a};const cs=8,ds=3,us=p.forwardRef((t,r)=>{const{top:a,prefixCls:s,getContainer:n,maxCount:c,duration:m=ds,rtl:f,transitionName:x,onAllRemoved:l}=t,{getPrefixCls:u,getPopupContainer:d,message:o}=p.useContext($e),i=s||u("message"),[,j]=Oe(i),v=()=>({left:"50%",transform:"translateX(-50%)",top:a??cs}),y=()=>le(j,{[`${i}-rtl`]:f}),b=()=>os(i,x),S=p.createElement("span",{className:`${i}-close-x`},p.createElement(st,{className:`${i}-close-icon`})),[I,A]=Wt({prefixCls:i,style:v,className:y,motion:b,closable:!1,closeIcon:S,duration:m,getContainer:()=>(n==null?void 0:n())||(d==null?void 0:d())||document.body,maxCount:c,onAllRemoved:l});return p.useImperativeHandle(r,()=>Object.assign(Object.assign({},I),{prefixCls:i,hashId:j,message:o})),A});let we=0;function ze(t){const r=p.useRef(null);return[p.useMemo(()=>{const s=x=>{var l;(l=r.current)===null||l===void 0||l.close(x)},n=x=>{if(!r.current){const D=()=>{};return D.then=()=>{},D}const{open:l,prefixCls:u,hashId:d,message:o}=r.current,i=`${u}-notice`,{content:j,icon:v,type:y,key:b,className:S,style:I,onClose:A}=x,g=is(x,["content","icon","type","key","className","style","onClose"]);let N=b;return N==null&&(we+=1,N=`antd-message-${we}`),ye(D=>(l(Object.assign(Object.assign({},g),{key:N,content:p.createElement(Ee,{prefixCls:u,type:y,icon:v},j),placement:"top",className:le(y&&`${i}-${y}`,d,S,o==null?void 0:o.className),style:Object.assign(Object.assign({},o==null?void 0:o.style),I),onClose:()=>{A==null||A(),D()}})),()=>{s(N)}))},m={open:n,destroy:x=>{var l;x!==void 0?s(x):(l=r.current)===null||l===void 0||l.destroy()}};return["info","success","warning","error","loading"].forEach(x=>{const l=(u,d,o)=>{let i;u&&typeof u=="object"&&"content"in u?i=u:i={content:u};let j,v;typeof d=="function"?v=d:(j=d,v=o);const y=Object.assign(Object.assign({onClose:v,duration:j},i),{type:x});return n(y)};m[x]=l}),m},[]),p.createElement(us,Object.assign({key:"message-holder"},t,{ref:r}))]}function ms(t){return ze(t)}let O=null,H=t=>t(),Z=[],ae={};function ps(){const{prefixCls:t,getContainer:r,duration:a,rtl:s,maxCount:n,top:c}=ae,m=t??ke().getPrefixCls("message"),f=(r==null?void 0:r())||document.body;return{prefixCls:m,container:f,duration:a,rtl:s,maxCount:n,top:c}}const xs=p.forwardRef((t,r)=>{const a=()=>{const{prefixCls:o,container:i,maxCount:j,duration:v,rtl:y,top:b}=ps();return{prefixCls:o,getContainer:()=>i,maxCount:j,duration:v,rtl:y,top:b}},[s,n]=p.useState(a),[c,m]=ze(s),f=ke(),x=f.getRootPrefixCls(),l=f.getIconPrefixCls(),u=f.getTheme(),d=()=>{n(a)};return p.useEffect(d,[]),p.useImperativeHandle(r,()=>{const o=Object.assign({},c);return Object.keys(o).forEach(i=>{o[i]=function(){return d(),c[i].apply(c,arguments)}}),{instance:o,sync:d}}),p.createElement(at,{prefixCls:x,iconPrefixCls:l,theme:u},m)});function ue(){if(!O){const t=document.createDocumentFragment(),r={fragment:t};O=r,H(()=>{nt(p.createElement(xs,{ref:a=>{const{instance:s,sync:n}=a||{};Promise.resolve().then(()=>{!r.instance&&s&&(r.instance=s,r.sync=n,ue())})}}),t)});return}O.instance&&(Z.forEach(t=>{const{type:r,skipped:a}=t;if(!a)switch(r){case"open":{H(()=>{const s=O.instance.open(Object.assign(Object.assign({},ae),t.config));s==null||s.then(t.resolve),t.setCloseFn(s)});break}case"destroy":H(()=>{O==null||O.instance.destroy(t.key)});break;default:H(()=>{var s;const n=(s=O.instance)[r].apply(s,rt(t.args));n==null||n.then(t.resolve),t.setCloseFn(n)})}}),Z=[])}function hs(t){ae=Object.assign(Object.assign({},ae),t),H(()=>{var r;(r=O==null?void 0:O.sync)===null||r===void 0||r.call(O)})}function fs(t){const r=ye(a=>{let s;const n={type:"open",config:t,resolve:a,setCloseFn:c=>{s=c}};return Z.push(n),()=>{s?H(()=>{s()}):n.skipped=!0}});return ue(),r}function js(t,r){const a=ye(s=>{let n;const c={type:t,args:r,resolve:s,setCloseFn:m=>{n=m}};return Z.push(c),()=>{n?H(()=>{n()}):c.skipped=!0}});return ue(),a}function bs(t){Z.push({type:"destroy",key:t}),ue()}const ys=["success","info","warning","error","loading"],gs={open:fs,destroy:bs,config:hs,useMessage:ms,_InternalPanelDoNotUseOrYouWillBeFired:ls},Qe=gs;ys.forEach(t=>{Qe[t]=function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return js(t,a)}});const Se=Qe;function vs(){const t=Y(),{list:r,total:a,loading:s}=k(c=>c.purchaseOrder);p.useEffect(()=>{t(Ne({page:1,count:10}))},[t]);const n=[{id:1,title:"ID",dataIndex:"reorderInvoiceId",key:"reorderInvoiceId",render:c=>e.jsx(z,{to:`/admin/purchase-reorder-invoice/${c}`,children:c}),renderCsv:c=>c},{id:2,title:"Create Date",dataIndex:"createdAt",key:"createdAt",render:c=>w(c).format("ll"),renderCsv:c=>w(c).format("DD/MM/YYYY")},{id:3,title:"Action",dataIndex:"reorderInvoiceId",key:"reorderInvoiceId",render:c=>e.jsx("div",{className:"flex flex-row",children:e.jsx(de,{path:`/admin/purchase-reorder-invoice/${c}`})}),csvOff:!0}];return e.jsx(E,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"Purchase Order ",extra:e.jsx(e.Fragment,{children:e.jsx($t,{permission:"create-purchaseInvoice",title:"Create Purchase order",width:50,children:e.jsx(kt,{})})}),children:e.jsx(je,{permission:"readAll-purchaseInvoice",children:e.jsx(be,{list:r,total:a,columns:n,loading:s,paginatedThunk:Ne,csvFileName:"Purchase Order list",title:"Purchase Order list"})})})}function Ns({data:t,title:r}){const{currencySymbol:a}=K()||{},s=k(o=>{var i;return(i=o==null?void 0:o.setting)==null?void 0:i.data})||null,n=Y();se(Math.round(t.totalAmount-t.discount)),oe(a);const c=[],m=[],f=["SI","Product Name","Quantity"],x=t.productList.map((o,i)=>[i+1,o.product.name,o.reorderProductQuantity]),l=[],u=[{value:`Invoice No: ${t==null?void 0:t.reorderInvoiceId}`},{value:`Invoice Date: ${w(t==null?void 0:t.createdAt).format("YYYY-MM-DD")}`}],d={jsPDF:{},tableFontSize:10,infoTopFontSize:10,bottomRightFontSize:12,bottomLeftFontSize:8,footerFontSize:10};return p.useEffect(()=>{!s&&n(W())},[n,s]),e.jsx("div",{className:"",children:e.jsx("button",{className:"bg-primary flex justify-center items-center px-4 py-[9px] text-white rounded",onClick:()=>te("print",{title:r,TopRightInfo:u,companyInfo:s,customerInfo:l,bottomLeftContent:c,bottomRightContent:m,tableBody:x,tableHead:f,settings:d}),children:"Print Invoice"})})}function Ps(){const{id:t}=ie(),r=Y(),{singlePurchase:a,loading:s}=k(l=>l.purchaseOrder),[n,c]=p.useState([]);p.useEffect(()=>{c(m),r(lt(t))},[r,t]);const m=[{id:1,title:"ID",dataIndex:"productId",key:"id"},{id:2,title:"Name",dataIndex:"product",key:"name",render:l=>e.jsxs(z,{to:`/admin/product/${l==null?void 0:l.id}`,children:[l.name," "]})},{id:4,title:"Sku",dataIndex:"product",key:"sku",render:l=>l.sku},{id:5,title:"Quantity",dataIndex:"reorderProductQuantity",key:"productQuantity"},{id:3,title:"Date",key:"createdAt",render:l=>w(l).format("ll")}],f=l=>{c(l)},x=l=>l==null?void 0:l.map(u=>({...u,key:u.id}));return e.jsx(e.Fragment,{children:e.jsxs(E,{title:e.jsxs("h5",{className:"flex flex-col",children:[e.jsxs("span",{className:"mr-left",children:["Purchase Order: ",t]}),e.jsxs("span",{className:"text-sm",children:["PO Date: ",w(a==null?void 0:a.createdAt).format("ll")]})]}),extra:e.jsx("div",{className:"flex gap-2",children:a&&e.jsx(Ns,{data:a,title:"Purchase Order Invoice"})}),children:[e.jsx("div",{className:"text-[18px] font-medium flex justify-center",children:"Purchase Order Product Information"}),a&&e.jsx("div",{children:e.jsx("div",{className:"flex justify-between my-3",children:e.jsx(Re,{options:m,columns:m,columnsToShowHandler:f})})}),e.jsx("div",{className:"",children:e.jsx(ee,{scroll:{x:!0},loading:s,columns:n,data:a?x(a==null?void 0:a.productList):[]})})]})})}function Is(){const t=Y(),{list:r,total:a,loading:s}=k(d=>d.purchaseReturn),{RangePicker:n}=U,[c,m]=p.useState(w().startOf("month").format("YYYY-MM-DD")),[f,x]=p.useState(w().endOf("month").format("YYYY-MM-DD")),l=[{id:1,title:"ID",dataIndex:"id",key:"id",render:d=>e.jsx(z,{to:`/admin/purchase-return-list/${d}`,children:d}),renderCsv:d=>d},{id:2,title:"Date",dataIndex:"date",key:"date",render:d=>w(d).format("ll"),renderCsv:d=>w(d).format("ll")},{id:3,title:"Purchase Invoice Id",dataIndex:"purchaseInvoiceId",key:"purchaseInvoiceId"},{id:4,title:"Notes",dataIndex:"note",key:"note"},{id:5,title:"Action",dataIndex:"id",key:"id",render:d=>e.jsx("div",{className:"flex flex-row",children:e.jsx(de,{path:`/admin/purchase-return-list/${d}`})}),csvOff:!0}];p.useEffect(()=>{t(Pe({status:!0,page:1,count:10,startDate:c,endDate:f}))},[t,f,c]);const u=d=>{const o=d[0].format("YYYY-MM-DD"),i=d[1].format("YYYY-MM-DD");m(o),x(i)};return e.jsx(E,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"Purchase Return ",extra:e.jsx(n,{onCalendarChange:u,defaultValue:[V(c,"YYYY-MM-DD"),V(f,"YYYY-MM-DD")],className:"range-picker",style:{maxWidth:"400px"}}),children:e.jsx(je,{permission:"readAll-returnPurchaseInvoice",children:e.jsx(be,{list:r,total:a,columns:l,loading:s,paginatedThunk:Pe,csvFileName:"purchase Return list",query:{startdate:c,enddate:f},title:"Purchase Return list"})})})}function Cs(){return e.jsx(e.Fragment,{children:e.jsx(Is,{})})}function As({data:t,title:r}){var j,v;const{currencySymbol:a,currencyName:s}=K()||{},n=k(y=>{var b;return(b=y==null?void 0:y.setting)==null?void 0:b.data})||null,c=Y(),m=[{value:` Invoice No: ${t==null?void 0:t.id}`},{value:`Invoice Date: ${w(t==null?void 0:t.date).format("YYYY-MM-DD")}`},{value:`currency : ${s}`}],x=[{label:"IN WORDS: ",value:`${se(Math.round((t==null?void 0:t.totalAmount)+(t!=null&&t.tax?t==null?void 0:t.tax:0))).toUpperCase()} ${s}`||""},{label:"Terms And Conditions: ",value:t!=null&&t.termsAndConditions?t.termsAndConditions:""},{label:"Notes: ",value:t!=null&&t.note?t==null?void 0:t.note:""}],l=[{label:"Total:",value:`${(t==null?void 0:t.totalAmount)-(t!=null&&t.discount?t==null?void 0:t.discount:0)}`},{label:"Tax Amount:",value:`${t!=null&&t.tax?t==null?void 0:t.tax:0}`},{label:"Grand Total:",value:`${(t==null?void 0:t.totalAmount)+(t!=null&&t.tax?t==null?void 0:t.tax:0)}`}],u=["SI","Product Description","Quantity","Purchase Price","Total Price","Total Tax"],d=t.returnPurchaseInvoiceProduct.map(y=>[y.id,y.product.name,y.productQuantity,`${y.product.productPurchasePrice}`,`${y.productFinalAmount*y.productQuantity}`,`${y.tax}`]),o=[{value:`Supplier: ${(v=(j=t==null?void 0:t.purchaseInvoice)==null?void 0:j.supplier)==null?void 0:v.name}`},{value:`Purchase Invoice Id: ${t==null?void 0:t.purchaseInvoiceId}`}],i={jsPDF:{},tableFontSize:10,infoTopFontSize:10,bottomRightFontSize:10,bottomLeftFontSize:8,footerFontSize:10};return p.useEffect(()=>{!n&&c(W())},[c,n]),e.jsx("div",{className:"",children:e.jsx("button",{className:"bg-primary cursor-pointer flex justify-center items-center px-4 py-[9px] text-white rounded",onClick:()=>te("print",{title:r,TopRightInfo:m,companyInfo:n,customerInfo:o,bottomLeftContent:x,bottomRightContent:l,tableBody:d,tableHead:u,settings:i,leftBottomSecondColumnX:32}),children:"Print Invoice"})})}function ws(){const t=Y(),{id:r}=ie(),[a,s]=p.useState([]),{returnPurchase:n,loading:c}=k(l=>l.purchaseReturn),m=[{id:1,title:"ID",dataIndex:"id",key:"id"},{id:2,title:"Product Name",key:"product",dataIndex:"product",render:l=>e.jsx(z,{to:`/admin/product/${l==null?void 0:l.id}`,children:l==null?void 0:l.name})},{id:3,title:"Date",dataIndex:"createdAt",key:"date",render:l=>w(l).format("ll")},{id:4,title:"Product Quantity",dataIndex:"productQuantity",key:"productQuantity"},{id:5,title:"Purcahse Price",dataIndex:"productUnitPurchasePrice",key:"productUnitPurchasePrice"},{id:5,title:"Total Tax",dataIndex:"taxAmount",key:"taxAmount"}];p.useEffect(()=>{s(m),t(ot(r))},[]);const f=l=>{s(l)},x=l=>l==null?void 0:l.map(u=>({...u,key:u.id}));return e.jsx(e.Fragment,{children:e.jsxs(E,{title:e.jsxs("h5",{className:"flex items-center",children:[e.jsx(vt,{}),e.jsxs("span",{className:"mr-left",children:["ID : ",r]})]}),extra:e.jsx("div",{className:"flex gap-2",children:n&&e.jsx(As,{title:"Purchase return Invoice",data:n})}),children:[e.jsx("div",{className:"text-[18px] font-medium flex justify-center",children:"Purchase Return Product Information"}),n&&e.jsx("div",{children:e.jsxs("div",{className:"flex justify-between my-2",children:[e.jsx(Re,{options:m,columns:m,columnsToShowHandler:f}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"bg-gray-100 px-2 py-1 rounded-sm m-1",children:["Purchase Invoice Id: ",n==null?void 0:n.purchaseInvoiceId]}),e.jsxs("div",{className:"bg-gray-100 px-2 py-1 rounded-sm m-1",children:["Date: ",w(n==null?void 0:n.createdAt).format("DD/MM/YYYY")]})]})]})}),e.jsx("div",{className:"mb-5 ",children:e.jsx(ee,{scroll:{x:!0},loading:!n,columns:a,data:n?x(n==null?void 0:n.returnPurchaseInvoiceProduct):[]})}),e.jsxs("div",{className:"font-bold text-[16px]",children:["Total Return Amount:"," ",((n==null?void 0:n.totalAmount)||0)+((n==null?void 0:n.tax)||0)]}),e.jsxs("h6",{className:" m-0 max-w-[500px] py-2",children:[e.jsx("span",{className:"font-bold",children:"Return Note:"}),e.jsxs("span",{className:"font-medium",children:[" ",n==null?void 0:n.note]})," "]})]})})}function De({data:t,pageConfig:r,supplier:a,title:s,info:n,type:c,btnName:m}){const{currencySymbol:f}=K()||{},x=k(b=>{var S;return(S=b==null?void 0:b.setting)==null?void 0:S.data})||null;Y(),se(Math.round((t==null?void 0:t.totalAmount)-(t==null?void 0:t.discount)));const l=oe(f),u=[],d=[{label:"Total",value:`${l}${n!=null&&n.totalAmount?n.totalAmount.toFixed(2):0}`},{label:"Paid",value:`${l}${n!=null&&n.paidAmount?n.paidAmount.toFixed(2):0}`},{label:"Due",value:`${l}${n!=null&&n.dueAmount?n.dueAmount.toFixed(2):0}`},{label:"Discount",value:`${l}${n!=null&&n.discount?n.discount.toFixed(2):0}`},{label:"Return",value:`${l}${n!=null&&n.totalReturnAmount?n.totalReturnAmount.toFixed(2):0}`}],o=["Date","Invoice","Supplier","Product ","QTY","Discount","Return","Total","Paid","Due"],i=t.map(b=>{var S;return[w(b.date).format("YYYY-MM-DD"),b.id,(S=b.supplier)==null?void 0:S.name,b.purchaseInvoiceProduct.map(I=>{var A;return(A=I==null?void 0:I.product)==null?void 0:A.name}).join(`,
`),b.purchaseInvoiceProduct.map(I=>I.productQuantity).join(`
`),`${l}${b.discount?b.discount:0}`,`${l}${b.returnAmount?b.returnAmount:0}`,`${l}${b.totalAmount?b.totalAmount:0}`,`${l}${b.paidAmount?b.paidAmount:0}`,`${l}${b.dueAmount?b.dueAmount:0}`]}),j=[{value:`Supplier: ${a||"All"}`,style:{bold:!0,fontSize:12}}],v=[{value:`From Date: ${w(r==null?void 0:r.startDate).format("YYYY-MM-DD")}`},{value:`To Date: ${w(r==null?void 0:r.endDate).format("YYYY-MM-DD")}`}],y={jsPDF:{},tableFontSize:8,infoTopFontSize:10,bottomRightFontSize:12,bottomLeftFontSize:8,footerFontSize:10};return e.jsx("div",{className:"flex gap-2",children:e.jsx(Q,{className:"bg-primary flex justify-center items-center px-4 py-2 text-white rounded",onClick:()=>te(c,{title:s,TopRightInfo:v,companyInfo:x,customerInfo:j,bottomLeftContent:u,bottomRightContent:d,tableBody:i,tableHead:o,settings:y}),children:m})})}function Ss({setPageConfig:t,pageConfig:r,setSupplier:a}){const s=Y(),{list:n,loading:c}=k(l=>l.suppliers),m=(l,u)=>{const d=l.split(","),o=d[0].trim(),i=d[1].trim();a(i),t(j=>({...j,[u]:o}))},f=l=>{const u=l.format("YYYY-MM-DD");t(d=>({...d,startDate:u}))},x=l=>{const u=l.format("YYYY-MM-DD");t(d=>({...d,endDate:u}))};return p.useEffect(()=>{s(xe({query:"all"}))},[s]),e.jsxs("div",{className:"flex flex-col items-center gap-2 p-5 m-4 rounded bg-white w-1/3",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-base py-2",children:"Select Supplier"}),e.jsx(L,{placeholder:"All",loading:c,allowClear:!0,showSearch:!1,style:{width:"100%"},maxTagPlaceholder:l=>e.jsxs("div",{className:"",children:[l.length," Selected"]}),maxTagCount:0,onChange:l=>m(l,"supplierId"),children:n==null?void 0:n.map(l=>e.jsx(L.Option,{value:`${l.id},${l.name}`,children:l==null?void 0:l.name},l.id))})]}),e.jsxs("div",{className:"w-full flex gap-3",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-base py-2",children:"From"}),e.jsx(U,{onChange:f,defaultValue:V(r.startDate,"YYYY-MM-DD")})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-base py-2",children:"To"}),e.jsx(U,{onChange:x,defaultValue:V(r.endDate,"YYYY-MM-DD")})]})]})]})}function Ds(){const t=Y(),[r,a]=p.useState(!1),[s,n]=p.useState(null),{list:c,loading:m,information:f}=k(o=>o.purchases),[x,l]=p.useState({query:"report",startDate:w().startOf("month").format("YYYY-MM-DD"),endDate:w().endOf("month").format("YYYY-MM-DD")}),u=[{id:1,title:"ID",key:"id",render:({id:o})=>e.jsx(z,{to:`/admin/purchase/${o}`,children:o})},{id:2,title:"Date",dataIndex:"date",key:"date",render:o=>w(o).format("ll")},{id:3,title:"Supplier Name ",dataIndex:"supplier",key:"supplierId",render:o=>e.jsx(z,{to:`/admin/supplier/${o==null?void 0:o.id}`,children:o==null?void 0:o.name})},{id:4,title:"Total Amount",dataIndex:"totalAmount",key:"totalAmount"},{id:5,title:"Discount",dataIndex:"discount",key:"discount"},{id:7,title:"Paid Amount",dataIndex:"paidAmount",key:"paidAmount"},{id:6,title:"Due Amount",dataIndex:"dueAmount",key:"dueAmount"}],d=[{id:2,title:"Date",dataIndex:"date",key:"date",renderCsv:o=>w(o).format("ll")},{id:1,title:"ID",dataIndex:"id",key:"id",renderCsv:o=>o},{id:3,title:"Supplier Name ",dataIndex:"supplier",key:"supplierId",renderCsv:o=>o==null?void 0:o.name},{id:3,title:"Product",dataIndex:"purchaseInvoiceProduct",key:"purchaseInvoiceProduct",renderCsv:o=>o.map(i=>i.product.name)},{id:4,title:"Total Amount",dataIndex:"totalAmount",key:"totalAmount"},{id:5,title:"Discount",dataIndex:"discount",key:"discount"},{id:7,title:"Paid Amount",dataIndex:"paidAmount",key:"paidAmount"},{id:6,title:"Due Amount",dataIndex:"dueAmount",key:"dueAmount"}];return p.useEffect(()=>{t(it(x))},[t,x]),e.jsx("div",{className:"card card-custom mt-3 ",children:e.jsx("div",{className:"card-body",children:e.jsxs(E,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"Purchase Report",children:[e.jsx(Ss,{setSupplier:n,setPageConfig:l,pageConfig:x}),e.jsxs("div",{className:"flex justify-between p-5 items-start ",children:[e.jsx("div",{children:e.jsx(Q,{onClick:()=>a(!0),className:"bg-green-500 text-white",children:"Generate Report"})}),e.jsxs("div",{className:"flex px-5 gap-2 items-center ",children:[!m&&c?e.jsx(De,{data:c,title:"Purchase Report",pageConfig:x,type:"print",btnName:"Print",info:f,supplier:s}):e.jsx("div",{children:e.jsx(Q,{loading:m||!c,className:"bg-primary text-white",children:"Print"})}),!m&&c?e.jsx(De,{data:c,title:"Purchase Report",pageConfig:x,info:f,type:"download",btnName:"Export PDF",setSupplier:n}):e.jsx("div",{children:e.jsx(Q,{loading:m||!c,className:"bg-primary text-white",children:"Export PDF"})}),e.jsx("div",{children:e.jsx(St,{list:c,columns:d,title:"Purchase Report",className:"bg-primary   h-auto py-2 ",btnName:"Export CSV"})})]})]}),r&&e.jsx(Et,{list:c,columns:u,loading:m})]})})})}function $s({form:t,totalCalculator:r}){const a=Y(),[s,n]=p.useState(""),c=p.useRef(null),{list:m}=k(u=>u.productSearch),f=u=>{const d=t.getFieldValue("purchaseInvoiceProduct")||[];if(d.find(i=>i.productId===u.id)){const i=d.map(j=>u.id===j.productId?{...j,productQuantity:j.productQuantity?j.productQuantity+1:1}:u);t.setFieldsValue({purchaseInvoiceProduct:i})}else t.setFieldsValue({purchaseInvoiceProduct:[...d,{productId:u.id,productQuantity:0,productSalePrice:u.productSalePrice,productPurchasePrice:u.productPurchasePrice,tax:0}]});r()},x=async u=>{c.current&&clearTimeout(c.current),n(u.target.value),c.current=setTimeout(async()=>{var d,o,i,j,v;if(u.target.value!==""){const y=await a(ct({query:"search",key:u.target.value,count:7}));((i=(o=(d=y.payload)==null?void 0:d.data)==null?void 0:o.getAllProduct)==null?void 0:i.length)===1&&(f((v=(j=y.payload)==null?void 0:j.data)==null?void 0:v.getAllProduct[0]),l())}else a(Ie())},500)},l=()=>{s!==""&&(n(""),a(Ie()))};return p.useEffect(()=>()=>{l()},[]),e.jsxs("div",{className:"relative w-[450px]",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:s,onChange:x,className:`w-full py-2 px-5 rounded-lg outline-0 ${(m==null?void 0:m.length)>0&&"rounded-b-none"}`,placeholder:"Search Product"}),s&&e.jsx("button",{type:"button",onClick:l,className:"text-black/50 absolute  right-8 h-full pl-2 pr-4 z-10 ",children:e.jsx(Nt,{size:25})}),e.jsx("button",{type:"submit",className:"text-gray-400 absolute  right-0 h-full pl-2 pr-4 z-10 ",children:e.jsx(Pt,{size:25})})]}),(m==null?void 0:m.length)>0&&e.jsx("div",{className:"absolute bg-white shadow-md z-20 w-full rounded-b-lg max-h-80 md:max-h-[600px] overflow-y-auto ",children:m.map(u=>e.jsx(ks,{onSelect:f,product:u,handleClear:l},u.id))})]})}function ks({product:t,onSelect:r,handleClear:a}){const{name:s,productQuantity:n}=t;return e.jsxs("div",{onClick:()=>{r(t),a()},className:"flex justify-between items-center gap-2 py-1 w-full px-5 hover:bg-slate-950/10 text-sm",children:[e.jsx("div",{className:"flex items-center gap-3 justify-start",children:e.jsx("h1",{className:"font-medium text-gray-700",children:s})}),e.jsx("div",{className:"",children:n>0?e.jsxs("span",{className:"bg-green-500/10 text-green-700 rounded px-2 flex gap-2",children:["Stock: ",e.jsx("span",{children:n})]}):e.jsx("span",{className:"bg-red-500/10 text-red-700 rounded px-2",children:"Stock out"})})]})}function Fs({form:t,productList:r,productLoading:a,totalCalculator:s,subTotal:n}){const c=(f,x)=>{const l=t.getFieldValue("purchaseInvoiceProduct"),u=r.find(o=>o.id===f),d=l.map((o,i)=>i===x?{...o,productQuantity:u.productQuantity?1:0,productSalePrice:u.productSalePrice,productPurchasePrice:u.productPurchasePrice,tax:0}:o);t.setFieldsValue({purchaseInvoiceProduct:d}),s(x)},m=f=>{var o,i;const x=(i=(o=t.getFieldValue("purchaseInvoiceProduct"))==null?void 0:o.find((j,v)=>v===f))==null?void 0:i.productId,l=r==null?void 0:r.find(j=>x===j.id);let u=null;Array.isArray(l==null?void 0:l.productColor)&&l.productColor.length>0&&(u=e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:"mr-1",children:"Color: "}),l.productColor.map((j,v)=>{var y;return e.jsxs("span",{children:[(y=j.color)==null?void 0:y.name,v!==l.productColor.length-1&&","]},j.id)})]}));let d=null;return l!=null&&l.productQuantity&&(d=e.jsxs("span",{children:[e.jsx("span",{className:"mr-1",children:"Stock: "}),e.jsx("span",{children:l.productQuantity})]})),{stock:d,colors:u}};return e.jsx(E,{className:"h-[calc(100vh-100px)]",headClass:"",bodyClass:"p-0",title:e.jsx($s,{form:t,totalCalculator:s}),children:e.jsx(C.List,{name:"purchaseInvoiceProduct",rules:[{required:!0,message:"Product is required"}],children:(f,{add:x,remove:l})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"max-h-[calc(100vh-220px)] overflow-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"font-Popins text-black bg-tableHeaderBg border-gray-200 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 pl-2 text-left",children:"SL"}),e.jsx("th",{className:"py-2 pl-2 text-left",children:"Product"}),e.jsx("th",{className:"py-2 pl-2 text-left",children:"Quantity"}),e.jsx("th",{className:"py-2 pl-2 text-left",children:"Purchase price"}),e.jsx("th",{className:"py-2 pl-2 text-left",children:"Selling price"}),e.jsx("th",{className:"py-2 pl-2 text-left",children:"Amount"}),e.jsx("th",{className:"py-2 pl-2 text-left",children:"Tax%"}),e.jsx("th",{className:"py-2 pl-2 text-left",children:"Tax"}),e.jsx("th",{className:"py-2 pl-2 text-left"})]})}),e.jsx("tbody",{className:"bg-tableBg",children:f.map(({key:u,name:d,...o},i)=>{var v,y,b,S;const j=m(i);return e.jsxs("tr",{className:`hover:bg-slate-900/10 py-1 ${i===f.length-1?"":"border-b"}`,children:[e.jsx("td",{className:"py-2 pl-2 align-top",children:i+1}),e.jsxs("td",{className:"py-2 pl-2 align-top",children:[e.jsx(C.Item,{...o,className:"mb-0  max-w-[250px]",name:[d,"productId"],rules:[{required:!0,message:"Product is required"}],children:e.jsx(L,{placeholder:"Select Product",showSearch:!0,loading:a,optionFilterProp:"children",filterOption:(I,A)=>A.children.toLowerCase().includes(I.toLowerCase()),onChange:I=>{c(I,i)},children:r==null?void 0:r.map(I=>e.jsx(L.Option,{value:I.id,children:I.name},I.id))})}),e.jsx("div",{className:"px-2",children:j.colors})]}),e.jsxs("td",{className:"py-2 pl-2 align-top",children:[e.jsx(C.Item,{...o,className:"mb-0 max-w-[100px]",name:[d,"productQuantity"],rules:[{required:!0,message:"quantity is required"}],children:e.jsx(q,{type:"number",size:"small",placeholder:"Quantity",onChange:()=>s(i)})}),e.jsx("div",{className:"px-2",children:j.stock})]}),e.jsx("td",{className:"py-2 pl-2 align-top",children:e.jsx(C.Item,{...o,className:"mb-0 max-w-[150px]",name:[d,"productPurchasePrice"],rules:[{required:!0,message:"Price is required"}],children:e.jsx(q,{size:"small",type:"number",placeholder:"50000",onChange:()=>s(i)})})}),e.jsx("td",{className:"py-2 pl-2 align-top",children:e.jsx(C.Item,{...o,className:"mb-0 max-w-[150px]",name:[d,"productSalePrice"],rules:[{required:!0,message:"Price is required"}],children:e.jsx(q,{size:"small",type:"number",placeholder:"50000",onChange:()=>s(i)})})}),e.jsx("td",{className:"py-2 pl-2 align-top min-w-[80px]",children:e.jsx("div",{className:"font-weight-bold totalMargin",children:((y=(v=n[i])==null?void 0:v.subPrice)==null?void 0:y.toFixed(2))||0})}),e.jsx("td",{className:"py-2 pl-2 align-top min-w-[80px]",children:e.jsx(C.Item,{...o,name:[d,"tax"],className:"mb-0 max-w-[100px]",rules:[{required:!0,message:"Tax is required"}],children:e.jsx(q,{size:"small",type:"number",style:{width:"100%"},defaultValue:0,onChange:()=>s(i)})})}),e.jsx("td",{className:"py-2 pl-2 align-top min-w-[80px]",children:e.jsx("div",{className:"font-weight-bold md:text-base xxs:text-xs",children:((S=(b=n[i])==null?void 0:b.totalVat)==null?void 0:S.toFixed(2))||0})}),e.jsx("td",{className:"py-2 pl-2 align-top",children:e.jsx(C.Item,{children:e.jsx("button",{shape:"circle",className:"flex justify-center items-center hover:bg-black/40 rounded-md",onClick:()=>{l(d),s(i)},children:e.jsx(fe,{size:25})})})})]},u)})})]})}),f.length===0&&e.jsx("div",{className:"text-center py-10",children:"No product selected yet"}),e.jsx("div",{className:"flex items-center justify-center mt-2",children:e.jsx(Q,{onClick:()=>x(),className:"flex items-center justify-center w-48",block:!0,icon:e.jsx(he,{}),children:"Add Product"})})]})})})}function Le({totalCalculator:t}){const r=Y(),{list:a,loading:s}=k(n=>n.accounts);return p.useEffect(()=>{r(Fe())},[r]),e.jsx(C.List,{name:"paidAmount",children:(n,{add:c,remove:m})=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"bg-tableBg",children:n.map(({key:f,name:x,...l},u)=>e.jsx("div",{className:" py-1 ",children:e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx(C.Item,{...l,name:[x,"amount"],className:"mb-0",rules:[{required:!0,message:"Amount is required"}],children:e.jsx(q,{className:"discountType",addonAfter:e.jsx(C.Item,{...l,name:[x,"paymentType"],noStyle:!0,rules:[{required:!0,message:"Payment type is required"}],children:e.jsx(L,{loading:s,size:"small",popupClassName:"min-w-[200px]",style:{width:100},placeholder:"Select Payment type",optionFilterProp:"children",filterOption:(d,o)=>o.children.includes(d),filterSort:(d,o)=>d.children.toLowerCase().localeCompare(o.children.toLowerCase()),children:a==null?void 0:a.map(d=>e.jsx(L.Option,{value:d.id,children:d.name},d.id))})}),placeholder:"0",style:{width:"100%"},size:"small",onChange:()=>t&&t(u)})}),e.jsx("button",{shape:"circle",className:"flex justify-center items-center hover:bg-black/40 rounded-md",onClick:()=>{m(x),t&&t(u)},children:e.jsx(fe,{size:25})})]})},f))}),e.jsx("div",{className:"flex items-center justify-center mt-2",children:e.jsx(J,{type:"dashed",size:"small",onClick:()=>c(),className:"flex items-center justify-center",block:!0,icon:e.jsx(he,{}),children:"Add Payment"})})]})})}const Ts=()=>{const{Option:t}=L,[r,a]=p.useState(!1),[s,n]=p.useState([]),[c,m]=p.useState(0),[f,x]=p.useState(),l=Te(),u=Y();p.useEffect(()=>{u(xe({status:!0,page:1,count:10})),u(dt({query:"all"}))},[u]);const d=k(g=>g.suppliers.list),{list:o,loading:i}=k(g=>g.products),[j]=C.useForm(),v=async g=>{try{const N=g.purchaseInvoiceProduct.reduce((P,$)=>{const R=$.productId;return P[R]?P[R].productQuantity+=$.productQuantity:P[R]={...$},P},{}),F=Object.values(N).map(P=>({...P,productId:P.productId,productQuantity:P.productQuantity,productUnitPurchasePrice:P.productPurchasePrice,productUnitSalePrice:P.productSalePrice,tax:P.tax})),M={...g,purchaseInvoiceProduct:F,paidAmount:g.paidAmount||[]},h=await u(ut(M));h.payload.message==="success"?(j.resetFields(),a(!1),l(`/admin/purchase/${h.payload.data.id}`)):a(!1)}catch{a(!1)}},y=()=>{const g=j.getFieldValue("purchaseInvoiceProduct"),N=(g==null?void 0:g.reduce((R,T)=>{const qe=(T==null?void 0:T.productQuantity)||0,He=(T==null?void 0:T.productPurchasePrice)||0,Ue=(T==null?void 0:T.tax)||0,ge=He*qe,Ge=Ue/100*ge;return[...R,{subPrice:ge,totalVat:Ge}]},[]))||[];n(N);const D=N==null?void 0:N.reduce((R,T)=>R+T.subPrice,0),F=N==null?void 0:N.reduce((R,T)=>R+T.totalVat,0),M=D+F,h=j.getFieldValue("paidAmount")||[],P=h==null?void 0:h.reduce((R,T)=>R+(T.amount?parseInt(T.amount):0),0),$=M-P;m($)},b=d==null?void 0:d.find(g=>g.id===f),S=s==null?void 0:s.reduce((g,N)=>g+N.subPrice,0),I=s==null?void 0:s.reduce((g,N)=>g+N.totalVat,0),A=S+I;return e.jsx(C,{form:j,className:"w-full ",name:"dynamic_form_nest_item",onFinish:v,onFinishFailed:()=>{a(!1)},layout:"vertical",size:"large",onKeyDown:g=>{g.key==="Enter"&&g.preventDefault()},autoComplete:"off",initialValues:{paidAmount:0,discount:0,date:V(),purchaseInvoiceProduct:[{}]},children:e.jsxs("div",{className:"flex gap-4 2xl:h-[calc(100vh-100px)] min-h-[500px]",children:[e.jsx("div",{className:"w-[70%] 2xl:w-[75%]",children:e.jsx(Fs,{totalCalculator:y,subTotal:s,form:j,productList:o,productLoading:i})}),e.jsxs("div",{className:"flex flex-col w-[30%] 2xl:w-[25%]",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"w-full",children:[e.jsx(C.Item,{label:e.jsxs(e.Fragment,{children:["Supplier"," ",e.jsx(zt,{className:"",title:"Add New Supplier",children:e.jsx(Qt,{drawer:!0})})]}),name:"supplierId",className:"w-full mb-0",rules:[{required:!0,message:"Please Select a supplier!"}],children:e.jsx(L,{className:"w-full",loading:!d,onChange:g=>x(g),showSearch:!0,placeholder:"Select a supplier ",optionFilterProp:"children",filterOption:(g,N)=>N.children.toLowerCase().includes(g.toLowerCase()),children:d&&d.map(g=>e.jsx(t,{value:g.id,children:g.name},g.id))})}),b&&e.jsxs("div",{className:"flex justify-between py-1 px-4",children:[e.jsxs("span",{children:[e.jsx("span",{children:"Address: "}),e.jsx("span",{children:b==null?void 0:b.address})," "]}),e.jsxs("span",{children:[e.jsx("span",{children:"Phone: "}),e.jsx("span",{children:b==null?void 0:b.phone})," "]})]})]}),e.jsx(C.Item,{name:"date",label:"Date",className:"w-full mb-0",layout:"horizental",required:!0,rules:[{required:!0,message:"Please input Date!"}],children:e.jsx(U,{size:"small",format:"YYYY-MM-DD",className:"date-picker"})}),e.jsx(C.Item,{className:"w-full mb-0",name:"supplierMemoNo",label:"Supplier Memo",children:e.jsx(G,{className:"w-full",placeholder:"Memo no "})}),e.jsx(C.Item,{className:"w-full mb-0",name:"note",label:"Note",children:e.jsx(G,{className:"w-full",placeholder:"Note"})})]}),e.jsxs("div",{className:"py-2",children:[e.jsxs("div",{className:" flex justify-between",children:[e.jsx("strong",{children:"Total amount: "}),e.jsx("strong",{children:S.toFixed(2)})]}),e.jsxs("div",{className:"py-1 flex justify-between items-center",children:[e.jsx("span",{children:"Total tax amount: "}),e.jsx("span",{children:I.toFixed(2)})]}),e.jsxs("div",{className:"py-1 flex justify-between items-center",children:[e.jsx("strong",{children:"Total Payable: "}),e.jsx("strong",{children:A.toFixed(2)})]}),e.jsxs("div",{className:"py-1 mb-4 flex justify-between",children:[e.jsx("strong",{children:"Due Amount:"}),e.jsx("strong",{children:c.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"",children:"Paid Amount: "}),e.jsx("div",{className:"w-[65%] flex items-center justify-between gap-2",children:e.jsx(Le,{totalCalculator:y})})]}),e.jsx(C.Item,{style:{marginTop:"15px"},children:e.jsx(J,{block:!0,type:"primary",htmlType:"submit",loading:r,onClick:()=>a(!0),children:"Create Purchase"})})]})]})]})})},Ys=Ts,Be=({list:t,updateReturn:r,returnOnChange:a})=>{const s=[{title:"ID",dataIndex:"productId",key:"productId"},{title:"Name",dataIndex:"product",key:"product.name",render:c=>e.jsx(z,{to:`/admin/product/${c.id}`,children:c.name}),tdClass:"whitespace-normal"},{title:r?"Returnable Quantity":"Quantity",dataIndex:"productQuantity",key:"productQuantity"},{title:"Price",dataIndex:"productUnitPurchasePrice",key:"productUnitPurchasePrice"},{title:"Amount",key:"Total Price ",dataIndex:"",render:({productFinalAmount:c})=>c},{title:"Tax amount",key:"Total Tax ",dataIndex:"taxAmount"}];r&&s.splice(4,0,{title:"Return Quantity",dataIndex:"returnQuantity",key:"return_quantity",width:"150px",render:(c,{id:m,productQuantity:f})=>e.jsx("div",{children:e.jsx(q,{onChange:x=>a({id:m,value:x}),style:{width:"120px"},placeholder:"Return Qty",max:f,min:0,value:c})})});const n=c=>c.map(m=>({...m,key:m.id}));return e.jsx("div",{className:"m-2",children:e.jsx(ee,{scroll:{x:!0},loading:!t,columns:s,data:t?n(t):[]})})},Ms=async t=>{try{const{data:r}=await mt({method:"post",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},url:"return-purchase-invoice/",data:{...t}});return pt(r)}catch(r){return xt(r,!0)}},Rs=()=>{const{id:t}=ie();let r=Te();const[a,s]=p.useState({}),[n,c]=p.useState(!1),[m,f]=p.useState(0),x=Y(),l=k(A=>A.purchases.purchase),{singlePurchaseInvoice:u,returnPurchaseInvoice:d}=l||{},[o,i]=p.useState([]),[j,v]=p.useState(w()),[y]=C.useForm();C.useWatch("name",y),p.useEffect(()=>{x(ce(t))},[t]),p.useEffect(()=>{if(u){const A=u.purchaseInvoiceProduct.map(g=>{const N=d==null?void 0:d.map(F=>F.returnPurchaseInvoiceProduct.find(M=>M.productId===g.productId)).reduce((F,M)=>M?{productQuantity:F.productQuantity+M.productQuantity}:F,{productQuantity:0}),D={...g};return N?(D.returnQuantity=0,D.productQuantity=D.productQuantity-N.productQuantity):(D.returnQuantity=0,D.remainQuantity=g.productQuantity),D});i(A)}},[u]);const b=async({note:A,paidAmount:g})=>{try{c(!0);const N={purchaseInvoiceId:t,note:A,date:w(j._d).format(),instantReturnAmount:g||[],returnPurchaseInvoiceProduct:Object.entries(a).map(([F,{value:M}])=>({purchaseInvoiceProductId:parseInt(F),productQuantity:M}))};(await Ms(N)).message==="success"&&r(-1),c(!1)}catch{c(!1)}},S=p.useCallback(({id:A,value:g})=>{const N=o.find(D=>D.id===A);N&&(a[A]={value:g},N.returnQuantity=g,N.remainQuantity=N.productQuantity-g,i([...o]),s({...a}))},[o]),I=()=>o.reduce((A,g)=>A+g.returnQuantity*g.productUnitPurchasePrice,0);return p.useEffect(()=>{f(I())},[o]),e.jsx("div",{children:e.jsx("div",{className:"mr-top",children:u?e.jsx(p.Fragment,{children:e.jsxs(ht,{bordered:!1,className:"criclebox h-full m-3",children:[e.jsx("div",{className:"flex justify-between",children:e.jsx("h5",{className:"text-xl",children:e.jsxs("span",{className:"mr-left",children:["Invoice : ",u.id]})})}),e.jsxs("div",{className:"",children:[e.jsx(Be,{formData:a,updateReturn:!0,returnOnChange:S,list:o}),e.jsxs("div",{className:"flex justify-between card-body my-4",children:[e.jsx("div",{className:"mb-auto"}),e.jsx("div",{className:"mr-right min-w-[400px]",children:e.jsxs(C,{labelAlign:"right",labelCol:{span:4},initialValues:{date:V(new Date)},wrapperCol:{span:26},form:y,onFinish:b,autoComplete:"off",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"",children:"Date: "}),e.jsx("div",{className:"w-[65%]",children:e.jsx(C.Item,{name:"date",className:"mb-0",children:e.jsx(U,{onChange:A=>v(A._d),style:{width:"100%"}})})})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"",children:"Note: "}),e.jsx("div",{className:"w-[65%]",children:e.jsx(C.Item,{name:"note",className:"mb-0",children:e.jsx(G.TextArea,{placeholder:"Note"})})})]}),e.jsxs("div",{className:"flex justify-between  mb-2 mt-3",children:[e.jsx("span",{className:"",children:"Total Return Amount: "}),e.jsx("div",{className:" font-semibold gap-2",children:m})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"",children:"Paid Amount: "}),e.jsx("div",{className:"w-[65%] flex items-center justify-between gap-2",children:e.jsx(Le,{})})]}),e.jsx(C.Item,{style:{marginTop:"20px"},className:"mb-2",children:e.jsx(Q,{className:"bg-red-500 hover:bg-red-600 text-white",type:"submit",block:!0,loading:n,children:"Make Return"})})]})})]})]})]})},u.id):e.jsx(Me,{})})})},Os=Rs,Es=({list:t})=>{const r=[{id:2,title:"ID",dataIndex:"id",key:"id"},{id:3,title:"Total Amount",key:"totalAmount",render:({totalAmount:s,tax:n})=>`${s+(n||0)}`},{id:4,title:"Note",dataIndex:"note",key:"note"},{id:3,title:"Date",dataIndex:"date",key:"date",render:s=>w(s).format("ll")},{id:1,title:"Action",key:"returnPurchaseInvoiceProduct",render:({id:s})=>e.jsx(de,{path:`/admin/purchase-return-list/${s}`})}],a=s=>s.map(n=>({...n,key:n.id}));return e.jsx("div",{className:"m-2",children:e.jsx(ee,{scroll:{x:!0},loading:!t,columns:r,data:t?a(t):[]})})},zs=({list:t})=>{const r=[{id:1,title:"ID",dataIndex:"id",key:"id",render:s=>e.jsx(z,{to:`/admin/transaction/${s}`,children:s})},{id:2,title:"Date",dataIndex:"date",key:"date",render:s=>w(s).format("ll")},{id:3,title:"Debit",dataIndex:"debit",key:"debit",render:s=>s.name},{id:4,title:"Credit",dataIndex:"credit",key:"credit",render:s=>s.name},{id:5,title:"Amount",dataIndex:"amount",key:"amount"},{id:6,title:"Type ",dataIndex:"type",key:"type"},{id:7,title:"Particulars",dataIndex:"particulars",key:"particulars",render:s=>e.jsx("div",{title:s,children:ft(s,20)})}],a=s=>s.map(n=>({...n,key:n.id}));return e.jsx("div",{className:"m-2",children:e.jsx(ee,{scroll:{x:!0},loading:!t,columns:r,data:t?a(t):[]})})};function Qs({data:t,title:r}){var N,D,F,M;const{currencySymbol:a,currencyName:s}=K()||{},n=k(h=>{var P;return(P=h==null?void 0:h.setting)==null?void 0:P.data})||null,c=Y(),m=se(Math.round(t.totalAmount+(t.totalTax?t.totalTax:0))),{status:f,totalPaidAmount:x,totalReturnAmount:l,instantPaidReturnAmount:u,dueAmount:d,singlePurchaseInvoice:o,returnPurchaseInvoice:i,transactions:j}=t||{};oe(a);const v=[{label:"IN WORDS: ",value:`${m.toUpperCase()} ${s}`||""},{label:"Terms And Conditions: ",value:t.termsAndConditions?t.termsAndConditions:""},{label:"Notes: ",value:t.note?t.note:""}],y=[{label:"Total Amount:",value:`${o.totalAmount.toFixed(2)}`},{label:"Total Tax:",value:`${o.totalTax.toFixed(2)}`},t.totalReturnAmount&&{label:"Return Product Value:",value:`${t.totalReturnAmount?t.totalReturnAmount.toFixed(2):0}`},t.instantPaidReturnAmount&&{label:"Return Value:",value:`${t.instantPaidReturnAmount?t.instantPaidReturnAmount.toFixed(2):0}`},{label:"Total Paid Amount:",value:`${x.toFixed(2)}`},{label:"Due Amount:",value:`${d.toFixed(2)}`}],b=["SI","Name","Quantity","Price","Amount","Tax"],S=(N=o==null?void 0:o.purchaseInvoiceProduct)==null?void 0:N.map(h=>[h.id,h.product.name,h.productQuantity,`${h.productUnitPurchasePrice}`,`${h.productFinalAmount}`,`${h.tax}`]),I=[{value:`Supplier Id: ${o==null?void 0:o.supplierId}`},{value:`Supplier Name: ${(D=o==null?void 0:o.supplier)==null?void 0:D.name}`},{value:`Address: ${(F=o==null?void 0:o.supplier)==null?void 0:F.address}`},{value:`Contact No: ${(M=o==null?void 0:o.supplier)==null?void 0:M.phone}`}],A=[{value:`Invoice No: ${o==null?void 0:o.id}`},{value:`Invoice Date: ${w(t==null?void 0:t.date).format("YYYY-MM-DD")}`},{value:`currency : ${s}`}],g={jsPDF:{},tableFontSize:10,infoTopFontSize:10,bottomRightFontSize:10,bottomLeftFontSize:8,footerFontSize:10};return p.useEffect(()=>{!n&&c(W())},[c,n]),e.jsx("div",{className:"",children:e.jsx(Q,{color:"primary",onClick:()=>te("print",{title:r,TopRightInfo:A,customerInfo:I,companyInfo:n,bottomLeftContent:v,bottomRightContent:y,tableBody:S,tableHead:b,settings:g,leftBottomSecondColumnX:32}),children:"Print"})})}function Ls(t,r,a,s){var i,j,v;const n=se(Math.round(t.totalAmount-t.discount)),c=oe(s),m=[{label:"In Words: ",value:n||""},{label:"Terms And Conditions: ",value:t.termsAndConditions?t.termsAndConditions:""},{label:"Notes: ",value:t.note?t.note:""}],f=[{label:"Sub Total:",value:`${c} ${t.totalAmount}`},{label:"Discount: (-)",value:`${c} ${t.discount?t.discount:0}`},{label:"Grand total:",value:`${c} ${t.totalAmount-(t.discount?t.discount:0)}`},{label:"Paid:",value:`${c} ${t.paidAmount}`},{label:"Due:",value:`${c} ${t.dueAmount}`}],x=["SI","Product Description","Quantity","Unit Price","Total Price"],l=t.purchaseInvoiceProduct.map(y=>[y.id,y.product.name,y.productQuantity,`${c} ${y.productUnitPurchasePrice}`,`${c} ${y.productUnitPurchasePrice*y.productQuantity}`]),u=[{value:`Client Id: ${t==null?void 0:t.supplierId}`},{value:`Client Name: ${(i=t==null?void 0:t.supplier)==null?void 0:i.name}`},{value:`Address: ${(j=t==null?void 0:t.supplier)==null?void 0:j.address}`},{value:`Contact No: ${(v=t==null?void 0:t.supplier)==null?void 0:v.phone}`}],d=[{value:`Invoice No: ${t==null?void 0:t.id}`},{value:`Invoice Date: ${w(t==null?void 0:t.date).format("YYYY-MM-DD")}`}];return te(null,{title:a,TopRightInfo:d,customerInfo:u,companyInfo:r,bottomLeftContent:m,bottomRightContent:f,tableBody:l,tableHead:x,settings:{jsPDF:{},tableFontSize:10,infoTopFontSize:10,bottomRightFontSize:10,bottomLeftFontSize:7,footerFontSize:10}})}function _e({setSendForm:t,setIsModalOpen:r,modal:a,body:s,subject:n,supplierEmail:c,onClose:m}){const[f]=C.useForm(),x=Y(),[l,u]=p.useState(!1),[d,o]=p.useState([]),[i,j]=p.useState([]),[v,y]=p.useState([]),[b,S]=p.useState(s),{purchase:I,loading:A}=k(P=>P.purchases),g=k(P=>{var $;return($=P==null?void 0:P.setting)==null?void 0:$.data})||null,{currencySymbol:N}=K()||{},D=async P=>{u(!0);try{let $=new FormData;$.append("receiverEmail",P.receiverEmail),$.append("subject",P.subject),$.append("body",b),d&&d.forEach(T=>{T.name==="Purchase Invoice.pdf"?$.append("files[]",T.originFileObj,"Purchase Invoice.pdf"):$.append("files[]",T.originFileObj)}),i.length>0&&$.append("cc[]",i),v.length>0&&$.append("bcc[]",v),(await x(jt($))).payload.message==="success"&&(t(!1),r(!1),u(!1),f.resetFields(),m&&m())}catch($){console.log($)}u(!1)},F=()=>{};p.useEffect(()=>{!g&&x(W())});const M=P=>{o(P.fileList);const{status:$}=P.file;$==="done"?Se.success(`${P.file.name} file uploaded successfully.`):$==="error"&&Se.error(`${P.file.name} file upload failed.`)};p.useEffect(()=>{I!=null&&I.singlePurchaseInvoice&&g&&o(P=>P.some($=>$.name==="Purchase Invoice.pdf")?P:[...P,{name:"Purchase Invoice.pdf",originFileObj:Ls(I.singlePurchaseInvoice,g,"Purchase Invoice",N)}])},[g,N,I==null?void 0:I.singlePurchaseInvoice]);const h=P=>{S(P)};return e.jsx(e.Fragment,{children:!A&&I&&e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:" "}),!a&&e.jsx("button",{onClick:()=>t(!1),className:"bg-red-100 p-1 rounded text-red-500",children:e.jsx(It,{size:20})})]}),e.jsxs(C,{onFinish:D,onFinishFailed:F,colon:!1,layout:"vertical",form:f,initialValues:{receiverEmail:c,subject:n,body:s},children:[e.jsx(C.Item,{style:{width:"100%"},label:"To",rules:[{required:!0,message:"Please input receiver email!"}],name:"receiverEmail",children:e.jsx(G,{placeholder:"Receiver Email"})}),e.jsx(Ae,{bordered:!1,defaultActiveKey:["0"],expandIcon:({isActive:P})=>e.jsx(Vt,{rotate:P?90:0}),className:"site-collapse-custom-collapse mb-4 ",children:e.jsxs(Ae.Panel,{header:"CC & BCC",children:[e.jsx(Ce,{label:"CC",tags:i,setTags:j}),e.jsx(Ce,{label:"BCC",tags:v,setTags:y})]},"1")}),e.jsx(C.Item,{style:{width:"100%"},label:"Subject",name:"subject",children:e.jsx(G,{placeholder:"Subject"})}),e.jsx(C.Item,{label:"Attachment",children:e.jsxs(Bt,{name:"files",onChange:M,multiple:!0,fileList:d,beforeUpload:()=>!1,children:[e.jsx("div",{className:"ant-upload-drag-icon flex justify-center my-2",children:e.jsx(Ft,{size:30})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})}),e.jsx(C.Item,{style:{marginBottom:"25px"},label:"Body",children:e.jsx(_t,{value:b,onChange:h,modules:qt,formats:Ht})}),e.jsx(C.Item,{children:e.jsx(J,{loading:l,size:"large",htmlType:"submit",type:"primary",children:"Send"})})]})]})})}function Bs({totalCalculator:t,form:r,setNewDue:a}){const s=Y(),{list:n,loading:c}=k(f=>f.accounts);p.useEffect(()=>{s(Fe())},[s]);const m=f=>{const l=(r.getFieldValue("paidAmount")||[]).reduce((u,d)=>u+((d==null?void 0:d.amount)||0),0);a(l),t&&t(f)};return e.jsx(C.List,{name:"paidAmount",children:(f,{add:x,remove:l})=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"bg-tableBg",children:f.map(({key:u,name:d,...o},i)=>e.jsx("div",{className:"py-1",children:e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx(C.Item,{...o,name:[d,"amount"],className:"mb-0",rules:[{required:!0,message:"Amount is required"}],children:e.jsx(q,{className:"discountType",addonAfter:e.jsx(C.Item,{...o,name:[d,"paymentType"],noStyle:!0,rules:[{required:!0,message:"Payment type is required"}],children:e.jsx(L,{loading:c,size:"small",popupClassName:"min-w-[200px]",style:{width:100},placeholder:"Select Payment type",optionFilterProp:"children",filterOption:(j,v)=>v.children.toLowerCase().includes(j.toLowerCase()),filterSort:(j,v)=>j.children.toLowerCase().localeCompare(v.children.toLowerCase()),children:n==null?void 0:n.map(j=>e.jsx(L.Option,{value:j.id,children:j.name},j.id))})}),placeholder:"0",style:{width:"100%"},size:"small",onChange:()=>m(i)})}),e.jsx("button",{shape:"circle",className:"flex justify-center items-center hover:bg-black/40 rounded-md",onClick:()=>{l(d),t&&t(i)},children:e.jsx(fe,{size:25})})]})},u))}),e.jsx("div",{className:"flex items-center justify-center mt-2",children:e.jsx(J,{type:"dashed",size:"small",onClick:()=>x(),className:"flex items-center justify-center",block:!0,icon:e.jsx(he,{}),children:"Add Payment"})})]})})}const Ve=({data:t,onClose:r,singlePage:a})=>{const{singlePurchaseInvoice:s,dueAmount:n}=t,c=s==null?void 0:s.id,m=Y(),{Title:f}=Kt,[x]=C.useForm();let[l,u]=p.useState(w());const[d,o]=p.useState(!1),[i,j]=p.useState(0),v=async b=>{o(!0);try{const S={date:l,purchaseInvoiceNo:parseInt(b.purchaseInvoiceNo),...b,paidAmount:b.paidAmount||[]};(await m(bt(S))).payload.message==="success"&&(o(!1),m(a?ce(c):Ye({page:1,count:10,status:"true",startDate:w().startOf("month").format("YYYY-MM-DD"),endDate:w().endOf("month").format("YYYY-MM-DD")})),r()),o(!1),x.resetFields()}catch{o(!1)}},y=b=>{o(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(f,{level:4,className:"text-center",children:["Due Amount :"," ",e.jsx("strong",{style:{color:"red"},children:(n==null?void 0:n.toFixed(2))||0})]}),i?e.jsxs("p",{className:"text-center text-lg font-semibold",children:["Remaining Amount :"," ",e.jsx("strong",{style:{color:"red"},children:(n-i).toFixed(2)})]}):"",e.jsxs(C,{form:x,className:"m-4 px-7",name:"basic",layout:"vertical",initialValues:{remember:!0,purchaseInvoiceNo:c,discount:0,paidAmount:[{}]},onFinish:v,onFinishFailed:y,autoComplete:"off",children:[e.jsx(C.Item,{label:"Date",rules:[{required:!0,message:"Please input the date!"}],style:{marginBottom:"10px"},children:e.jsx(U,{onChange:b=>u(b==null?void 0:b._d),defaultValue:V(),label:"date",name:"date",rules:[{required:!0,message:"Please input Date"}]})}),e.jsxs("div",{className:"mt-5",children:[e.jsxs("span",{children:["Paid Amount",n&&e.jsx("button",{type:"button",onClick:()=>{x.setFieldsValue({paidAmount:[{amount:n}]}),j(0)},className:"ml-3 bg-blue-200 rounded px-1",children:"Full Paid"})]}),e.jsx(Bs,{setNewDue:j,form:x})]}),e.jsx(C.Item,{style:{marginBottom:"10px",marginTop:"20px"},label:"Purchase Invoice No",name:"purchaseInvoiceNo",validateStatus:"success",children:e.jsx(G,{disabled:!0})}),e.jsx(C.Item,{style:{marginBottom:"10px"},wrapperCol:{offset:8,span:16},children:e.jsx(J,{className:"mt-5",block:!0,type:"primary",htmlType:"submit",shape:"round",loading:d,children:"Pay Now"})})]})]})},_s=()=>{var g,N;const{id:t}=ie(),[r,a]=p.useState(!1),[s,n]=p.useState(!1),c=k(D=>{var F;return(F=D==null?void 0:D.setting)==null?void 0:F.data})||null,m=Y(),f=k(D=>D.purchases.purchase),{status:x,totalPaidAmount:l,totalReturnAmount:u,instantPaidReturnAmount:d,dueAmount:o,singlePurchaseInvoice:i,returnPurchaseInvoice:j,transactions:v}=f||{};p.useEffect(()=>(m(ce(t)),()=>{m(yt())}),[m,t]);const[y,b]=p.useState(!1),S=(g=i==null?void 0:i.supplier)==null?void 0:g.email,I=`Your order has been received. Order ID #${i==null?void 0:i.id} `,A=`<div>
        <p>Dear <strong>${(N=i==null?void 0:i.supplier)==null?void 0:N.name}</strong>,</p>
        <p>Greetings! We trust this message reaches you in great spirits. We are immensely grateful for the privilege of having you as our esteemed supplier.</p>
    </div>
<br>
    <div class="order-info">
        <strong>Order Information:</strong><br>
        Order ID: ${i==null?void 0:i.id}<br>
        Order Date: ${w(i==null?void 0:i.date).format("ll")}
    </div>
<br>
    <div class="invoice-details">
        <strong>Invoice Details:</strong><br>
        Total Amount: $${i!=null&&i.totalAmount?Number(i.totalAmount).toFixed(2):0}<br>
        Tax: $${i!=null&&i.totalTax?Number(i.totalTax).toFixed(2):0}<br>
        Paid Amount: $${l?Number(l).toFixed(2):0}<br>
        Due Amount: $${o?Number(o).toFixed(2):0}
    </div>
<br>
    <div class="company-info">
        Best Regards,<br>
        <strong>${c==null?void 0:c.companyName}</strong><br>
        ${c==null?void 0:c.phone}<br>
        ${c==null?void 0:c.email}
    </div>`;return p.useEffect(()=>{!c&&m(W())},[m,c]),e.jsxs("div",{children:[e.jsx("div",{children:i?e.jsxs("div",{className:"flex gap-2 md:gap-4",children:[e.jsxs(E,{className:"w-2/3",bodyClass:"p-0",children:[e.jsx("div",{className:"flex justify-between mx-2 py-2 border-b items-center",children:e.jsxs("div",{className:" flex gap-3",children:[e.jsx("div",{children:i&&e.jsx(Qs,{title:"Purchase Invoice",data:f})}),e.jsx(Q,{className:"flex-row-reverse",color:"gray",icon:e.jsx(Tt,{size:15}),onClick:()=>{a(!0)},children:"Send"}),e.jsx(Xt,{content:e.jsx(Yt,{items:[{label:e.jsx(e.Fragment,{children:e.jsx("span",{onClick:()=>{b({singlePurchaseInvoice:i,dueAmount:o})},children:e.jsx("button",{className:"flex items-center gap-2 rounded disabled:cursor-not-allowed disabled:opacity-50 py-1",disabled:(f==null?void 0:f.dueAmount)<=0,children:"Make a payment"})})}),key:"edit"},{key:"status",label:e.jsxs(z,{to:`/admin/purchase/return/${t}`,children:["Return Product"," "]})}]}),placement:"bottomRight",arrow:!1,trigger:"click",children:e.jsx(Q,{color:"gray",icon:e.jsx(Mt,{size:15}),className:"  px-3"})})]})}),r?e.jsx("div",{children:e.jsx(_e,{subject:I,body:A,setSendForm:a,supplierEmail:S})}):e.jsxs(Ct,{className:"mt-4",children:[e.jsx(me,{label:"Products",children:e.jsx(Be,{list:i.purchaseInvoiceProduct})}),e.jsx(me,{label:"Return products",children:e.jsx(Es,{list:j})}),e.jsx(me,{label:"Transactions",children:e.jsx(zs,{list:v})})]})]}),e.jsxs("div",{className:"w-1/3 flex flex-col gap-2",children:[e.jsx(E,{title:e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"font-normal",children:["Invoice No"," ",e.jsxs("span",{className:"font-semibold",children:["#",i.id]})]})}),children:e.jsx(e.Fragment,{children:e.jsx(re,{labelClassName:"w-[40%]",list:[{label:"Invoice Date",value:w(i.createdAt).format("ll")},{label:"Payment",value:e.jsx(Dt,{color:x==="PAID"?"green":"red",children:x})}]})})}),e.jsx(E,{title:"Payment Details ",children:e.jsx(re,{list:[{label:"Total Amount",value:i!=null&&i.totalAmount?Number(i.totalAmount).toFixed(2):0},{label:"Total Tax",value:e.jsx("div",{className:"before:content-['+'] relative before:absolute before:text-green-500 before:font-bold before:-left-3 before:top-0",children:i!=null&&i.totalTax?Number(i.totalTax).toFixed(2):0}),hidden:(i==null?void 0:i.totalTaxAmount)===0},{label:"Return Product Value",value:e.jsx("div",{className:"before:content-['-'] relative before:absolute before:text-red-500 before:font-bold before:-left-3 before:top-0",children:u?Number(u).toFixed(2):0}),hidden:u===0&&d===0},{label:"Return Amount",value:e.jsxs("div",{className:"before:content-['+'] relative before:absolute before:text-green-500 before:font-bold before:-left-3 before:top-0",children:[d?Number(d).toFixed(2):0,u!=d&&e.jsx(Q,{onClick:()=>n(!0),className:"absolute right-4 -top-[23px] inline-block w-auto min-w-[100px] border-blue-400 border-[1.5px] rounded px-3",children:"Get Refund"})]}),hidden:u===0&&d===0},{label:"Total Paid Amount",value:e.jsx("div",{className:"before:content-['-'] relative before:absolute before:text-red-500 before:font-bold before:-left-3 before:top-0",children:l?Number(l).toFixed(2):0}),className:"border-b pb-1"},{label:"Due Amount",value:o?Number(o).toFixed(2):0}]})}),e.jsx(E,{title:"Supplier Details",children:e.jsx(re,{labelClassName:"w-[40%]",list:[{label:"Name",value:e.jsx(z,{to:`/admin/supplier/${i.supplier.id}`,children:i.supplier.name})},{label:"Phone",value:i.supplier.phone},{label:"Address",value:i.supplier.address}]})}),e.jsx(E,{children:e.jsx(re,{labelClassName:"w-[40%] font-bold",list:[{label:"Note",value:i.note,className:"flex-col gap-1"}]})})]})]}):e.jsx(Me,{})}),e.jsx(At,{title:"Get Refund",width:"40%",onClose:()=>n(!1),open:s,bodyStyle:{paddingBottom:80},children:e.jsx(Lt,{dueAmount:Math.abs(o),id:t,preFieldValue:{relatedId:i==null?void 0:i.id,type:"purchase_return"}})}),e.jsx(pe,{outsideClick:!0,open:y,title:"Make Purchase",className:"bg-white",onClose:()=>b(!1),children:e.jsx(Ve,{singlePage:!0,data:y,onClose:()=>b(!1)})})]})},Vs=_s,qs=({information:t,count:r})=>{var s,n,c,m;const a=K();return e.jsx(p.Fragment,{children:e.jsxs("section",{className:"grid sm:grid-cols-2 xl:grid-cols-4 gap-6 mt-5 mb-5",children:[e.jsxs("div",{className:"ant-shadow w-full relative sm:p-2 dark:bg-[#2e2d35] flex sm:justify-center items-center md:p-6 p-2 bg-white rounded-lg dashboard-card-bg",children:[e.jsx("div",{className:"sm:hidden inline-flex flex-shrink-0 items-center justify-center h-14 w-14 text-violet-600 bg-violet-100 rounded-lg mr-6",children:e.jsx(Rt,{size:30})}),e.jsx("div",{children:e.jsxs(ne,{title:e.jsxs("span",{className:"text-lg",children:[e.jsx("span",{dangerouslySetInnerHTML:{__html:a==null?void 0:a.currencySymbol}}),(s=t==null?void 0:t.totalAmount)==null?void 0:s.toFixed(3)]}),children:[e.jsxs("span",{className:"block text-violet-600 text-2xl sm:text-3xl font-bold sm:text-center",children:[" ",e.jsx("span",{dangerouslySetInnerHTML:{__html:a==null?void 0:a.currencySymbol}}),t!=null&&t.totalAmount?X(Number(t==null?void 0:t.totalAmount)):0]}),e.jsxs("span",{className:"uppercase sm:text-[14px] block font-semibold sm:font-bold sm:mt-2  dark:text-yellow-100 ",children:["Total Purchases"," ",e.jsxs("span",{className:"text-violet-600",children:["#",r?X(r):0]})]})]})})]}),e.jsxs("div",{className:"ant-shadow w-full relative sm:p-2 dark:bg-[#2e2d35] flex sm:justify-center items-center md:p-6 p-2 bg-white rounded-lg dashboard-card-bg",children:[e.jsx("div",{className:"sm:hidden inline-flex flex-shrink-0 items-center justify-center h-14 w-14 text-violet-500 bg-violet-100 rounded-lg mr-6",children:e.jsx(Jt,{size:30})}),e.jsx("div",{children:e.jsxs(ne,{title:e.jsxs("span",{className:"text-lg",children:[e.jsx("span",{dangerouslySetInnerHTML:{__html:a==null?void 0:a.currencySymbol}}),(n=t==null?void 0:t.paidAmount)==null?void 0:n.toFixed(3)]}),children:[e.jsxs("span",{className:"block text-violet-500 text-2xl sm:text-3xl font-bold sm:text-center",children:[e.jsx("span",{dangerouslySetInnerHTML:{__html:a==null?void 0:a.currencySymbol}}),t!=null&&t.paidAmount?X(Number(t.paidAmount)):0]}),e.jsxs("span",{className:"uppercase sm:text-[14px] block font-semibold sm:font-bold sm:mt-2  dark:text-yellow-100 ",children:["Total Purchase Paid"," "]})]})})]}),e.jsxs("div",{className:"ant-shadow w-full relative sm:p-2 dark:bg-[#2e2d35] flex sm:justify-center items-center md:p-6 p-2 bg-white rounded-lg dashboard-card-bg",children:[e.jsx("div",{className:"sm:hidden inline-flex flex-shrink-0 items-center justify-center h-14 w-14 text-blue-600 bg-blue-100 rounded-lg mr-6",children:e.jsx(es,{size:30})}),e.jsx("div",{children:e.jsxs(ne,{title:e.jsxs("span",{className:"text-lg",children:[e.jsx("span",{dangerouslySetInnerHTML:{__html:a==null?void 0:a.currencySymbol}}),(c=t==null?void 0:t.dueAmount)==null?void 0:c.toFixed(3)]}),children:[e.jsxs("span",{className:"block text-blue-600 text-2xl sm:text-3xl font-bold sm:text-center",children:[e.jsx("span",{dangerouslySetInnerHTML:{__html:a==null?void 0:a.currencySymbol}}),t!=null&&t.dueAmount?X(t==null?void 0:t.dueAmount):0]}),e.jsxs("span",{className:"uppercase sm:text-[14px] block font-semibold sm:font-bold sm:mt-2 dark:text-yellow-100 ",children:[" ","Total Purchase Due"," "]})]})})]}),e.jsxs("div",{className:"ant-shadow w-full relative sm:p-2 dark:bg-[#2e2d35] flex sm:justify-center items-center md:p-6 p-2 bg-white rounded-lg dashboard-card-bg",children:[e.jsx("div",{className:"sm:hidden inline-flex flex-shrink-0 items-center justify-center h-14 w-14 text-blue-600 bg-blue-100 rounded-lg mr-6",children:e.jsx(ts,{size:30})}),e.jsx("div",{children:e.jsxs(ne,{title:e.jsxs("span",{className:"text-lg",children:[e.jsx("span",{dangerouslySetInnerHTML:{__html:a==null?void 0:a.currencySymbol}}),(m=t==null?void 0:t.totalReturnAmount)==null?void 0:m.toFixed(3)]}),children:[e.jsxs("span",{className:"block text-blue-600 text-2xl sm:text-3xl font-bold sm:text-center",children:[e.jsx("span",{dangerouslySetInnerHTML:{__html:a==null?void 0:a.currencySymbol}}),t!=null&&t.totalReturnAmount?X(t==null?void 0:t.totalReturnAmount):0]}),e.jsxs("span",{className:"uppercase sm:text-[14px] block font-semibold sm:font-bold sm:mt-2 dark:text-yellow-100 ",children:[" ","Total Purchase Return"]})]})})]})]})})},Hs=()=>{var F,M;const{RangePicker:t}=U,[r,a]=p.useState(!1),[s,n]=p.useState({}),c=Y(),{list:m,total:f,loading:x,information:l}=k(h=>h.purchases),u=k(h=>{var P;return(P=h==null?void 0:h.setting)==null?void 0:P.data})||null,[d,o]=p.useState(!1),{list:i}=k(h=>h.suppliers),[j,v]=p.useState({page:1,count:10,status:"true",startDate:w().startOf("month").format("YYYY-MM-DD"),endDate:w().endOf("month").format("YYYY-MM-DD")}),y=(F=s==null?void 0:s.supplier)==null?void 0:F.email,b=`Your order has been received. Order ID #${s==null?void 0:s.id} `,S=`<div>
        <p>Dear <strong>${(M=s==null?void 0:s.supplier)==null?void 0:M.name}</strong>,</p>
        <p>Greetings! We trust this message reaches you in great spirits. We are immensely grateful for the privilege of having you as our esteemed supplier.</p>
    </div>
<br>
    <div class="order-info">
        <strong>Order Information:</strong><br>
        Order ID: ${s==null?void 0:s.id}<br>
        Order Date: ${w(s==null?void 0:s.date).format("ll")}
    </div>
<br>
    <div class="invoice-details">
        <strong>Invoice Details:</strong><br>
        Total Amount: $${s!=null&&s.totalAmount?Number(s.totalAmount).toFixed(2):0}<br>
        Tax: $${s!=null&&s.totalTax?Number(s.totalTax).toFixed(2):0}<br>
       
    </div>
<br>
    <div class="company-info">
        Best Regards,<br>
        <strong>${u==null?void 0:u.companyName}</strong><br>
        ${u==null?void 0:u.phone}<br>
        ${u==null?void 0:u.email}
    </div>`,I=[{id:1,title:"Invoice",key:"id",render:({id:h})=>e.jsx(z,{to:`/admin/purchase/${h}`,children:h}),renderCsv:({id:h})=>h},{id:2,title:"Date",dataIndex:"date",key:"date",render:h=>w(h).format("ll"),renderCsv:h=>w(h).format("ll")},{id:3,title:"Supplier",dataIndex:"supplier",key:"supplierId",render:h=>e.jsx(z,{to:`/admin/supplier/${h==null?void 0:h.id}`,children:h==null?void 0:h.name}),renderCsv:h=>h==null?void 0:h.name},{id:4,title:"Total Amount",dataIndex:"totalAmount",key:"totalAmount",render:h=>h.toFixed(2)},{id:7,title:"Paid",dataIndex:"paidAmount",key:"paidAmount",render:h=>h.toFixed(2)},{id:6,title:"Due",dataIndex:"dueAmount",key:"dueAmount",render:h=>h.toFixed(2)},{id:4,title:"Tax",dataIndex:"totalTax",key:"totalTax",render:h=>h.toFixed(2)},{id:8,title:"",dataIndex:"",key:"action",render:h=>[{label:e.jsx(de,{title:"View",path:`/admin/purchase/${h==null?void 0:h.id}`}),key:"view"},{label:e.jsx(e.Fragment,{children:e.jsx("span",{onClick:()=>{o(h)},children:e.jsxs("button",{className:"flex items-center gap-2 rounded disabled:cursor-not-allowed disabled:opacity-50 py-1",disabled:(h==null?void 0:h.dueAmount)<=0,children:[e.jsx(wt,{className:"text-[1rem]"}),"Make a payment"]})})}),key:"edit"},{label:e.jsxs("div",{onClick:()=>{N(),c(ce(h==null?void 0:h.id)),n(h)},className:"flex gap-2  items-center cursor-pointer",children:[e.jsx(Ot,{className:"text-[1rem]"}),"Email"]}),key:"SendEmail"}],csvOff:!0}],A=[{key:"supplierId",label:"Supplier",type:"select",options:i==null?void 0:i.map(h=>({label:h==null?void 0:h.name,value:h==null?void 0:h.id})),className:"min-w-[123px] max-w-[150px]",popupClassName:"w-[200px]"}];p.useEffect(()=>{c(Ye(j)),!u&&c(W())},[u,c,j]);const g=h=>{const P=h[0].format("YYYY-MM-DD"),$=h[1].format("YYYY-MM-DD");v(R=>({...R,startDate:P,endDate:$}))},N=()=>{a(!0)},D=()=>{a(!1),n({})};return p.useEffect(()=>{c(xe({query:"all"}))},[c]),e.jsxs("div",{className:"card card-custom mt-3 ",children:[e.jsxs("div",{className:"card-body",children:[e.jsx(qs,{information:l,count:f}),e.jsx("br",{}),e.jsx(E,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"Purchase Invoice",extra:e.jsxs("div",{className:"justify-between md:justify-start flex gap-3 items-center",children:[e.jsx("div",{children:e.jsx(t,{className:"range-picker ",onCalendarChange:g,defaultValue:[V(j.startDate,"YYYY-MM-DD"),V(j.endDate,"YYYY-MM-DD")]})}),e.jsx(Zt,{to:"/admin/purchase/add",title:"Create Purchase"})]}),children:e.jsx(je,{permission:"readAll-purchaseInvoice",children:e.jsx(be,{list:m,total:f,columns:I,loading:x,setPageConfig:v,title:"Purchase List",filters:A,isSearch:!0})})})]}),e.jsx(pe,{title:"Send Purchase Invoice",outsideClick:!0,open:r,className:"bg-white",onClose:D,footer:!1,children:e.jsx(_e,{subject:b,body:S,supplierEmail:y,setIsModalOpen:a,modal:!0,onClose:()=>a(!1)})}),e.jsx(pe,{outsideClick:!0,open:d,title:"Make Purchase",className:"bg-white",onClose:()=>o(!1),children:e.jsx(Ve,{data:d,onClose:()=>o(!1)})})]})},Us=Hs;function Qn(){return e.jsxs(gt,{children:[e.jsx(B,{path:"/purchase",exact:!0,element:e.jsx(_,{permission:"readAll-purchaseInvoice",children:e.jsx(Us,{})})}),e.jsx(B,{path:"/purchase/add",exact:!0,element:e.jsx(_,{permission:"create-purchaseInvoice",children:e.jsx(Ys,{})})}),e.jsx(B,{path:"/purchase/:id",element:e.jsx(_,{permission:"readSingle-purchaseInvoice",children:e.jsx(Vs,{})})}),e.jsx(B,{path:"/purchase-report",element:e.jsx(_,{permission:"readAll-purchaseInvoice",children:e.jsx(Ds,{})})}),e.jsx(B,{path:"/purchase/return/:id",element:e.jsx(_,{permission:"create-returnPurchaseInvoice",children:e.jsx(Os,{})})}),e.jsx(B,{path:"/purchase-return-list",element:e.jsx(_,{permission:"readAll-returnPurchaseInvoice",children:e.jsx(Cs,{})})}),e.jsx(B,{path:"/purchase-return-list/:id",element:e.jsx(_,{permission:"readSingle-returnPurchaseInvoice",children:e.jsx(ws,{})})}),e.jsx(B,{path:"/purchase-reorder-invoice",element:e.jsx(_,{permission:"readAll-purchaseReorderInvoice",children:e.jsx(vs,{})})}),e.jsx(B,{path:"/purchase-reorder-invoice/:id",element:e.jsx(_,{permission:"readSingle-purchaseReorderInvoice",children:e.jsx(Ps,{})})})]})}export{Qn as default};

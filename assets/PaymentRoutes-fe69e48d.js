import{Q as me,aH as ue,T as pe,aC as he,r as c,U as xe,aQ as ge,z as fe,Y as ye,_ as je,F as u,u as N,b as I,c1 as H,j as e,I as A,P as q,B as O,d$ as be,e0 as T,e1 as z,ce as J,e2 as Ce,e3 as ve,e4 as Pe,k as M,L as B,q as Se,e5 as we,e as K,a5 as Z,o as ee,C as te,cp as Ie,a0 as Ne,a1 as Ae,c5 as Me,e6 as se,bh as Oe,e7 as $e,x as De,y as D}from"./index-16ff5701.js";import{d as k}from"./dayjs.min-72f12467.js";import{C as U,U as R,T as ae,a as Fe}from"./TableComponent-f70e0475.js";import{C as ne}from"./CreateDrawer-33537b52.js";import{B as E}from"./BigDrawer-5db64386.js";import{R as re}from"./index-4f6b3efe.js";import{A as Te}from"./AddAccount-215a6d3d.js";import{S as C,a as L}from"./Button-81cb4f36.js";import{U as oe}from"./index-0daf2765.js";import{A as Le}from"./AddCustomer-1220d5e7.js";import{S as _}from"./index-8b1cef28.js";import{U as Be}from"./UpdatePayment-d92c5999.js";import{D as Y}from"./index-f03f7796.js";import{M as le}from"./index-2e4f1652.js";import{R as Re}from"./ReportTable-1374d75d.js";import{i as Ye}from"./invoiceGenerator-91e8874d.js";import{n as Ee}from"./numberToWords-4c291141.js";import{u as He}from"./useCurrency-ff395f2c.js";import{e as qe,S as ze,P as F}from"./AdminLayout-ac80ae52.js";import{I as ke}from"./index-6d01e873.js";import{T as ie}from"./index-1ab3c210.js";import{C as Ue}from"./CommonDelete-6a643bdc.js";import{S as Ve}from"./index-0065de40.js";import{E as _e}from"./EditOutlined-f754bc7b.js";import"./useForceUpdate-5b1eefe7.js";import"./DeleteOutlined-e1f8fe69.js";import"./fade-f955b557.js";import"./UploadMany-ab6f4635.js";import"./index-1b45a375.js";import"./InfoCircleFilled-829db91a.js";import"./jspdf.es.min-3ec80e90.js";function G(t,a){return{[`${t}, ${t}:hover, ${t}:focus`]:{color:a.colorTextDisabled,cursor:"not-allowed"}}}function X(t){return{backgroundColor:t.itemSelectedBg,boxShadow:t.boxShadowTertiary}}const Ge=Object.assign({overflow:"hidden"},ue),Xe=t=>{const{componentCls:a}=t;return{[a]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},he(t)),{display:"inline-block",padding:t.segmentedPadding,color:t.itemColor,backgroundColor:t.segmentedBgColor,borderRadius:t.borderRadius,transition:`all ${t.motionDurationMid} ${t.motionEaseInOut}`,[`${a}-group`]:{position:"relative",display:"flex",alignItems:"stretch",justifyItems:"flex-start",width:"100%"},[`&${a}-rtl`]:{direction:"rtl"},[`&${a}-block`]:{display:"flex"},[`&${a}-block ${a}-item`]:{flex:1,minWidth:0},[`${a}-item`]:{position:"relative",textAlign:"center",cursor:"pointer",transition:`color ${t.motionDurationMid} ${t.motionEaseInOut}`,borderRadius:t.borderRadiusSM,"&-selected":Object.assign(Object.assign({},X(t)),{color:t.itemHoverColor}),"&::after":{content:'""',position:"absolute",width:"100%",height:"100%",top:0,insetInlineStart:0,borderRadius:"inherit",transition:`background-color ${t.motionDurationMid}`,pointerEvents:"none"},[`&:hover:not(${a}-item-selected):not(${a}-item-disabled)`]:{color:t.itemHoverColor,"&::after":{backgroundColor:t.itemHoverBg}},[`&:active:not(${a}-item-selected):not(${a}-item-disabled)`]:{color:t.itemHoverColor,"&::after":{backgroundColor:t.itemActiveBg}},"&-label":Object.assign({minHeight:t.controlHeight-t.segmentedPadding*2,lineHeight:`${t.controlHeight-t.segmentedPadding*2}px`,padding:`0 ${t.segmentedPaddingHorizontal}px`},Ge),"&-icon + *":{marginInlineStart:t.marginSM/2},"&-input":{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:0,height:0,opacity:0,pointerEvents:"none"}},[`${a}-thumb`]:Object.assign(Object.assign({},X(t)),{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:0,height:"100%",padding:`${t.paddingXXS}px 0`,borderRadius:t.borderRadiusSM,[`& ~ ${a}-item:not(${a}-item-selected):not(${a}-item-disabled)::after`]:{backgroundColor:"transparent"}}),[`&${a}-lg`]:{borderRadius:t.borderRadiusLG,[`${a}-item-label`]:{minHeight:t.controlHeightLG-t.segmentedPadding*2,lineHeight:`${t.controlHeightLG-t.segmentedPadding*2}px`,padding:`0 ${t.segmentedPaddingHorizontal}px`,fontSize:t.fontSizeLG},[`${a}-item, ${a}-thumb`]:{borderRadius:t.borderRadius}},[`&${a}-sm`]:{borderRadius:t.borderRadiusSM,[`${a}-item-label`]:{minHeight:t.controlHeightSM-t.segmentedPadding*2,lineHeight:`${t.controlHeightSM-t.segmentedPadding*2}px`,padding:`0 ${t.segmentedPaddingHorizontalSM}px`},[`${a}-item, ${a}-thumb`]:{borderRadius:t.borderRadiusXS}}}),G(`&-disabled ${a}-item`,t)),G(`${a}-item-disabled`,t)),{[`${a}-thumb-motion-appear-active`]:{transition:`transform ${t.motionDurationSlow} ${t.motionEaseInOut}, width ${t.motionDurationSlow} ${t.motionEaseInOut}`,willChange:"transform, width"}})}},We=me("Segmented",t=>{const{lineWidth:a,lineWidthBold:i,colorBgLayout:o}=t,n=pe(t,{segmentedPadding:i,segmentedBgColor:o,segmentedPaddingHorizontal:t.controlPaddingHorizontal-a,segmentedPaddingHorizontalSM:t.controlPaddingHorizontalSM-a});return[Xe(n)]},t=>{const{colorTextLabel:a,colorText:i,colorFillSecondary:o,colorBgElevated:n,colorFill:h}=t;return{itemColor:a,itemHoverColor:i,itemHoverBg:o,itemSelectedBg:n,itemActiveBg:h}});var W=globalThis&&globalThis.__rest||function(t,a){var i={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&a.indexOf(o)<0&&(i[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,o=Object.getOwnPropertySymbols(t);n<o.length;n++)a.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(t,o[n])&&(i[o[n]]=t[o[n]]);return i};function Qe(t){return typeof t=="object"&&!!(t!=null&&t.icon)}const Je=c.forwardRef((t,a)=>{const{prefixCls:i,className:o,rootClassName:n,block:h,options:d=[],size:f="middle",style:g}=t,l=W(t,["prefixCls","className","rootClassName","block","options","size","style"]),{getPrefixCls:r,direction:s,segmented:y}=c.useContext(xe),p=r("segmented",i),[P,m]=We(p),x=ge(f),S=c.useMemo(()=>d.map(v=>{if(Qe(v)){const{icon:b,label:w}=v,V=W(v,["icon","label"]);return Object.assign(Object.assign({},V),{label:c.createElement(c.Fragment,null,c.createElement("span",{className:`${p}-item-icon`},b),w&&c.createElement("span",null,w))})}return v}),[d,p]),$=fe(o,n,y==null?void 0:y.className,{[`${p}-block`]:h,[`${p}-sm`]:x==="small",[`${p}-lg`]:x==="large"},m),j=Object.assign(Object.assign({},y==null?void 0:y.style),g);return P(c.createElement(Ve,Object.assign({},l,{className:$,style:j,options:S,ref:a,prefixCls:p,direction:s})))}),Ke=Je;var Ze={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M678.3 655.4c24.2-13 51.9-20.4 81.4-20.4h.1c3 0 4.4-3.6 2.2-5.6a371.67 371.67 0 00-103.7-65.8c-.4-.2-.8-.3-1.2-.5C719.2 518 759.6 444.7 759.6 362c0-137-110.8-248-247.5-248S264.7 225 264.7 362c0 82.7 40.4 156 102.6 201.1-.4.2-.8.3-1.2.5-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00137 901.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C357 641.2 432.2 610 512.2 610c56.7 0 111.1 15.7 158 45.1a8.1 8.1 0 008.1.3zM512.2 534c-45.8 0-88.9-17.9-121.4-50.4A171.2 171.2 0 01340.5 362c0-45.9 17.9-89.1 50.3-121.6S466.3 190 512.2 190s88.9 17.9 121.4 50.4A171.2 171.2 0 01683.9 362c0 45.9-17.9 89.1-50.3 121.6C601.1 516.1 558 534 512.2 534zM880 772H640c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h240c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"user-delete",theme:"outlined"};const et=Ze;var tt=function(a,i){return c.createElement(ye,je({},a,{ref:i,icon:et}))};const st=c.forwardRef(tt);function de(){const[t]=u.useForm(),a=N(),[i,o]=c.useState(!1),[n,h]=c.useState([]),[d,f]=c.useState(null),[g,l]=c.useState(""),{list:r,loading:s}=I(j=>j.accounts),y=async j=>{try{let v=new FormData;v.append("methodName",j.methodName),v.append("subAccountId",d),v.append("ownerAccount",j.ownerAccount),v.append("instruction",g),v.append("images[]",n[0].originFileObj),(await a(be(v))).payload.message==="success"&&(h([]),f(null),a(T({status:"true",page:1,count:10}))),o(!1)}catch{o(!1)}},p=()=>{},P=({fileList:j})=>{h(j)},m=j=>{f(j)},x=j=>{l(j)};c.useEffect(()=>{a(H())},[a]);const S=["header","font","size","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image","color","background"],$={toolbar:[[{header:"1"},{header:"2"},{font:[]}],[{list:"ordered"},{list:"bullet"}],["bold","italic","underline"],["link","image"],[{color:[]},{background:[]}],["clean"]]};return e.jsx("div",{children:e.jsxs(u,{form:t,name:"basic",layout:"vertical",className:"sm:mx-10",initialValues:{remember:!0},onFinish:y,onFinishFailed:p,autoComplete:"off",children:[e.jsx(u.Item,{style:{marginBottom:"15px"},label:"Method Name",name:"methodName",rules:[{required:!0,message:"Please input method name!"}],children:e.jsx(A,{})}),e.jsxs("div",{className:"flex items-center flex-wrap",children:[e.jsx(u.Item,{style:{marginBottom:"15px"},label:"Owner Account",name:"ownerAccount",className:"w-full",rules:[{required:!0,message:"Please input owner account!"}],children:e.jsx(A,{})})," ",e.jsx(u.Item,{style:{marginBottom:"15px"},label:e.jsxs(e.Fragment,{children:["Sub Account",e.jsx(E,{title:"new Account",children:e.jsx(Te,{drawer:!0})})]}),name:"subAccountId",className:"w-full",rules:[{required:d===null,message:"Please input sub account!"}],children:e.jsx(C,{name:"subAccountId",loading:s,showSearch:!0,placeholder:"Select Sub Account",optionFilterProp:"children",filterOption:(j,v)=>v.children.includes(j),filterSort:(j,v)=>j.children.toLowerCase().localeCompare(v.children.toLowerCase()),onChange:m,children:r&&r.map(j=>e.jsx(C.Option,{value:j.id,children:j.name},j.id))})})]}),e.jsx(u.Item,{label:"Upload Logo ",valuePropName:"Logo",required:!0,children:e.jsx(oe,{listType:"picture-card",beforeUpload:()=>!1,name:"image",fileList:n,maxCount:1,onChange:P,accept:"image/png, image/jpg, image/jpeg",children:e.jsxs("div",{children:[e.jsx(q,{}),e.jsx("div",{style:{marginTop:8},children:"Upload"})]})})}),e.jsx(u.Item,{style:{marginBottom:"15px"},label:"Instruction",name:"instruction",rules:[{required:!0,message:"Please input instruction !"}],children:e.jsx(re,{value:g,onChange:x,modules:$,formats:S})}),e.jsx(u.Item,{style:{marginBottom:"15px"},className:"flex justify-center mt-[24px]",children:e.jsx(O,{type:"primary",htmlType:"submit",shape:"round",loading:i,onClick:()=>{o(!0)},children:"Create payment Method"})})]})})}function at(){const[t]=u.useForm(),a=N(),[i,o]=c.useState(!1),{list:n,loading:h}=I(m=>m.paymentMethod),{list:d}=I(m=>m.customers),[f,g]=c.useState(null),[l,r]=c.useState(null),s=m=>{const x={...m,paymentMethodId:f,customerId:l};a(Ce(x)).payload.message=="success"&&a(ve({page:1,count:10,status:"true"})),o(!1)},y=()=>{};c.useEffect(()=>{a(z()),a(J({query:"all"}))},[a]);const p=m=>{g(m)},P=m=>{r(m)};return e.jsx("div",{children:e.jsxs(u,{form:t,name:"basic",layout:"vertical",className:"sm:mx-10",initialValues:{remember:!0},onFinish:s,onFinishFailed:y,autoComplete:"off",children:[e.jsx(u.Item,{style:{marginBottom:"15px"},label:"Payment Method",name:"paymentMethodId",rules:[{required:f===null,message:"Please select payment method !"}],children:e.jsxs(_.Compact,{block:!0,children:[e.jsx(C,{name:"paymentMethodId",loading:h,showSearch:!0,placeholder:"Select Payment Method",optionFilterProp:"children",filterOption:(m,x)=>x.children.includes(m),filterSort:(m,x)=>m.children.toLowerCase().localeCompare(x.children.toLowerCase()),onChange:p,children:n&&n.map(m=>e.jsx(C.Option,{value:m.id,children:m.methodName},m.id))}),e.jsx(E,{btnTitle:"Add Payment Method",title:"new Payment Method",children:e.jsx(de,{})})]})}),e.jsx(u.Item,{style:{marginBottom:"15px"},label:"Customer",name:"customerId",rules:[{required:l===null,message:"Please select customer !"}],children:e.jsxs(_.Compact,{block:!0,children:[e.jsx(C,{name:"paymentMethodId",loading:!d,showSearch:!0,placeholder:"Select Payment Method",optionFilterProp:"children",filterOption:(m,x)=>x.children.includes(m),filterSort:(m,x)=>m.children.toLowerCase().localeCompare(x.children.toLowerCase()),onChange:P,children:d&&d.map(m=>e.jsx(C.Option,{value:m.id,children:m.username},m.id))}),e.jsx(E,{btnTitle:"Add Customer",title:"new customer",children:e.jsx(Le,{})})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(u.Item,{style:{marginBottom:"15px"},label:"Amount",name:"amount",className:"w-full",rules:[{required:!0,message:"Please input amount !"}],children:e.jsx(A,{})}),e.jsx(u.Item,{style:{marginBottom:"15px"},label:"Order Id",name:"cartOrderId",className:"w-full",rules:[{required:!0,message:"Please select Order !"}],children:e.jsx(A,{})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(u.Item,{style:{marginBottom:"15px"},label:"Customer Account",name:"CustomerAccount",className:"w-full",rules:[{required:!0,message:"Please select customer account!"}],children:e.jsx(A,{})}),e.jsx(u.Item,{style:{marginBottom:"15px"},label:"TRX Id",name:"CustomerTransactionId",className:"w-full",rules:[{required:!0,message:"Please input Customer Transaction Id !"}],children:e.jsx(A,{})})]}),e.jsx(u.Item,{style:{marginBottom:"15px"},className:"flex justify-center mt-[24px]",children:e.jsx(O,{type:"primary",htmlType:"submit",shape:"round",loading:i,onClick:()=>{o(!0)},children:"Create Manual Payment"})})]})})}function nt({setPageConfig:t}){const{list:a,loading:i}=I(n=>n.paymentMethod),o=(n,h)=>{t(d=>({...d,[h]:n,page:1}))};return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"filterTag float-left min-w-[145px] max-w-[150px]",children:e.jsx(C,{placeholder:"Payment Method",loading:i,showSearch:!1,style:{width:"100%"},maxTagPlaceholder:n=>e.jsxs("div",{className:"",children:[n.length," Selected"]}),maxTagCount:0,onChange:n=>o(n,"paymentMethodId"),allowClear:!0,children:a==null?void 0:a.map(n=>e.jsx(C.Option,{value:n.id,children:n==null?void 0:n.methodName},n.id))})}),e.jsx("div",{className:"filterTag float-left min-w-[85px] max-w-[150px]",children:e.jsxs(C,{placeholder:"Status",className:"",showSearch:!1,mode:"multiple",style:{width:"100%"},maxTagPlaceholder:n=>e.jsxs("div",{className:"",children:[n.length," Selected"]}),maxTagCount:0,onChange:n=>o(n,"status"),children:[e.jsx(C.Option,{value:"true",children:"Show"},"true"),e.jsx(C.Option,{value:"false",children:"Hide"},"false")]})})]})}function rt(){const t=N(),[a,i]=c.useState(!1),{list:o,total:n,loading:h}=I(s=>s.manualPayment),[d,f]=c.useState({page:1,count:10,status:"true"}),g=()=>{i(!1)},l=[{id:1,title:"Invoice No",dataIndex:"cartOrderId",key:"cartOrderId",render:s=>e.jsx(B,{to:`/admin/order/${s}`,children:s}),renderCsv:s=>s},{id:2,title:"Customer",dataIndex:"customer",key:"customer",render:s=>e.jsx(B,{to:`/admin/hr/staffs/${s.id}`,children:s.username}),renderCsv:s=>s.username},{id:3,title:"Account No",dataIndex:"customerAccount",key:"customerAccount",render:s=>s||"-",renderCsv:s=>s},{id:4,title:"Amount",dataIndex:"amount",key:"amount"},{id:5,title:"Method",dataIndex:"paymentMethod",key:"paymentMethod",render:s=>s.methodName,renderCsv:s=>s.methodName},{id:6,title:"TRX ID",dataIndex:"customerTransactionId",key:"customerTransactionId",render:s=>s||"-",renderCsv:s=>s},{id:7,title:"Created At",dataIndex:"createdAt",key:"createdAt",render:s=>M(s).format("YYYY-MM-DD"),renderCsv:s=>M(s).format("YYYY-MM-DD")},{id:8,title:"Action",key:"Action",render:s=>e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(R,{permission:"update-manualPayment",children:e.jsx(Be,{data:s})})}),csvOff:!0}];c.useEffect(()=>{t(Pe(d))},[t,d]),c.useEffect(()=>{t(z())},[t]);const r=s=>{const y=s.format("YYYY-MM-DD");f(p=>({...p,fromDate:y}))};return e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"E-Com Payments",extra:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(Y,{onChange:r,allowClear:!0,className:"sm:w-2/5 md:w-[30%]",defaultValue:k(M().endOf("month").format("YYYY-MM-DD"),"YYYY-MM-DD")}),e.jsx(ne,{className:"sm:w-3/5 md:w-[70%]",permission:"create-manualPayment",title:"Create Manual Payment",width:35,children:e.jsx(at,{})})]}),children:e.jsx(R,{permission:"readAll-manualPayment",children:e.jsx(ae,{total:n,columns:l,list:o,loading:h,setPageConfig:f,title:"Manual Payment List",isSearch:!0,filter:e.jsx(nt,{setPageConfig:f})})})}),e.jsx(le,{title:"Update Manual Payment",open:a,onCancel:g,footer:!1})]})}function Q({data:t,title:a,type:i,info:o,payInfo:n,btnName:h}){const{currencySymbol:d}=He()||{},f=I(x=>{var S;return(S=x==null?void 0:x.setting)==null?void 0:S.data})||null;N(),Ee(Math.round((t==null?void 0:t.totalAmount)-(t==null?void 0:t.discount)));const g=Se(d),l=[],r=[{label:"Total",value:` ${g}${o.totalAmount?o.totalAmount:0}`}],s=["SL","Date","Invoice No","Customer","Account No","Method","TRX Id","Amount"],y=t.map((x,S)=>[S+1,M(x.createdAt).format("DD-MM-YYYY"),x.cartOrderId,x.customer.username,x.customerAccount,x.paymentMethod.methodName,x.customerTransactionId,`${g}${x.amount?x.amount:0}`]),p=[{value:`Customer: ${n.customer?n.customer:"All"}`},{value:`Payment Method: ${n.method?n.method:"All"}`}],P=[{value:`Report Date: ${M().format("YYYY-MM-DD")}`}],m={jsPDF:{},tableFontSize:10,infoTopFontSize:10,bottomRightFontSize:12,bottomLeftFontSize:8,footerFontSize:10};return e.jsx("div",{className:"flex gap-2",children:e.jsx(L,{className:"bg-primary flex justify-center items-center px-4 py-2 text-white rounded",onClick:()=>Ye(i,{title:a,TopRightInfo:P,companyInfo:f,customerInfo:p,bottomLeftContent:l,bottomRightContent:r,tableBody:y,tableHead:s,settings:m}),children:h})})}function ot({setPageConfig:t,pageConfig:a,setPayInfo:i}){const o=N(),{list:n,loading:h}=I(r=>r.customers),{list:d,loading:f}=I(r=>r.paymentMethod),g=(r,s)=>{const y=r.split(","),p=y[0].trim(),[P,m]=y[1].split(":"),x=P.trim();x==="payment"?i(S=>({...S,method:m.trim()})):x==="customer"&&i(S=>({...S,customer:m.trim()})),t(S=>({...S,[s]:p}))},l=r=>{const s=r.format("YYYY-MM-DD");t(y=>({...y,fromDate:s}))};return c.useEffect(()=>{o(J({query:"all"})),o(z({query:"all"}))},[o]),e.jsxs("div",{className:"flex flex-col items-center gap-2 md:p-4 rounded bg-white w-full md:w-1/3",children:[e.jsxs("div",{className:"w-full flex flex-col gap-3",children:[" ",e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-base py-2",children:"Select Customer"}),e.jsx(C,{placeholder:"All",loading:h,showSearch:!1,allowClear:!0,style:{width:"100%"},maxTagPlaceholder:r=>e.jsxs("div",{className:"",children:[r.length," Selected"]}),maxTagCount:0,onChange:r=>g(r,"customerId"),children:n==null?void 0:n.map(r=>e.jsx(C.Option,{value:`${r.id},customer:${r.username}`,children:r==null?void 0:r.username},r.id))})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-base py-2",children:"Select Payment Method"}),e.jsx(C,{placeholder:"All",loading:f,allowClear:!0,showSearch:!1,style:{width:"100%"},maxTagPlaceholder:r=>e.jsxs("div",{className:"",children:[r.length," Selected"]}),maxTagCount:0,onChange:r=>g(r,"paymentMethodId"),children:d==null?void 0:d.map(r=>e.jsx(C.Option,{value:`${r.id},payment:${r.methodName}`,children:r==null?void 0:r.methodName},r.id))})]})]}),e.jsx("div",{className:"w-full flex gap-3",children:e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-base py-2",children:"From"}),e.jsx(Y,{onChange:l})]})})]})}function lt(){const t=N(),[a,i]=c.useState(!1),{list:o,loading:n,info:h}=I(s=>s.manualPayment),[d,f]=c.useState({customer:null,method:null}),[g,l]=c.useState({query:"report"}),r=[{id:1,title:"Invoice No",dataIndex:"cartOrderId",key:"cartOrderId",render:s=>e.jsx(B,{to:`/admin/order/${s}`,children:s})},{id:2,title:"Customer",dataIndex:"customer",key:"customer",render:s=>e.jsx(B,{to:`/admin/hr/staffs/${s.id}`,children:s.username})},{id:3,title:"Account No",dataIndex:"customerAccount",key:"customerAccount",render:s=>s||"-"},{id:4,title:"Amount",dataIndex:"amount",key:"amount"},{id:5,title:"Method",dataIndex:"paymentMethod",key:"paymentMethod",render:s=>s.methodName},{id:6,title:"TRX ID",dataIndex:"customerTransactionId",key:"customerTransactionId",render:s=>s||"-"},{id:7,title:"Created At",dataIndex:"createdAt",key:"createdAt",render:s=>M(s).format("YYYY-MM-DD")}];return c.useEffect(()=>{t(we(g))},[t,g]),e.jsx("div",{className:"card card-custom mt-3 ",children:e.jsx("div",{className:"card-body",children:e.jsxs(U,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"Payment Report",children:[e.jsx(ot,{setPageConfig:l,pageConfig:g,setPayInfo:f}),e.jsxs("div",{className:"flex justify-between p-5 items-start ",children:[e.jsx("div",{children:e.jsx(L,{onClick:()=>i(!0),className:"bg-green-500 text-white",children:"Generate Report"})}),e.jsxs("div",{className:"flex px-5 items-center gap-2 ",children:[!n&&o?e.jsx(Q,{data:o,info:h,payInfo:d,title:"Payment Report",pageConfig:g,type:"print",btnName:"Print"}):e.jsx("div",{children:e.jsx(L,{loading:n||!o,className:"bg-primary text-white",children:"Print"})}),!n&&o?e.jsx(Q,{data:o,payInfo:d,title:"Payment Report",info:h,pageConfig:g,type:"download",btnName:"Export PDF"}):e.jsx("div",{children:e.jsx(L,{loading:n||!o,className:"bg-primary text-white",children:"Export PDF"})}),e.jsx("div",{children:e.jsx(Fe,{className:"bg-primary text-white ",list:o,columns:r,title:"Payment Report",btnName:"Export CSV",children:"Export CSV"})})]})]}),a&&e.jsx(Re,{list:o,columns:r,loading:n})]})})})}function ce({totalCalculator:t}){const a=N(),{list:i,loading:o}=I(n=>n.accounts);return c.useEffect(()=>{a(H())},[a]),e.jsx(u.List,{name:"paidAmount",rules:[{required:!0}],children:(n,{add:h,remove:d})=>e.jsxs("div",{className:"flex flex-col mb-2",children:[e.jsx("div",{className:"bg-tableBg",children:n.map(({key:f,name:g,...l},r)=>e.jsx("div",{className:"py-1",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(u.Item,{...l,name:[g,"amount"],className:"mb-0 w-full",rules:[{required:!0,message:"Amount is required"}],children:e.jsx(ke,{className:"discountType",addonAfter:e.jsx(u.Item,{...l,name:[g,"paymentType"],noStyle:!0,rules:[{required:!0,message:"Payment type is required"}],children:e.jsx(C,{loading:o,size:"small",popupClassName:"min-w-[200px]",style:{width:180},placeholder:"Select Payment type",optionFilterProp:"children",filterOption:(s,y)=>y.children.includes(s),filterSort:(s,y)=>s.children.toLowerCase().localeCompare(y.children.toLowerCase()),children:i==null?void 0:i.map(s=>e.jsx(C.Option,{value:s.id,children:s.name},s.id))})}),placeholder:"0",style:{width:"100%"},size:"small",onChange:()=>t&&t(r)})}),e.jsx("button",{shape:"circle",className:"flex justify-center items-center hover:bg-black/40 rounded-md",onClick:()=>{d(g),t&&t(r)},children:e.jsx(qe,{size:25})})]})},f))}),e.jsx("div",{className:"flex items-center justify-center mt-2",children:e.jsx(O,{type:"dashed",size:"small",onClick:()=>h(),className:"flex items-center justify-center",block:!0,icon:e.jsx(q,{}),children:"Add Payment"})})]})})}const it=()=>{const t=K(),a=Z(),{pid:i}=ee(),{dueAmount:o}=(a==null?void 0:a.state)||{},n=N(),{Title:h}=ie,[d]=u.useForm();let[f,g]=c.useState(M());const[l,r]=c.useState(!1),s=async p=>{r(!0);try{const P={date:f,...p,paidAmount:p.paidAmount||[]};(await n(Ie(P))).payload.message==="success"&&(t(-1),r(!1)),r(!1),d.resetFields()}catch{r(!1)}},y=p=>{r(!1)};return e.jsx(e.Fragment,{children:e.jsxs(te,{bordered:!1,className:" max-w-[700px] ",children:[e.jsx(h,{level:3,className:"m-3 text-center",children:"Sale Invoice Payment"}),e.jsxs(h,{level:4,className:"text-center",children:["Due Amount :"," ",e.jsx("strong",{style:{color:"red"},children:(o==null?void 0:o.toFixed(3))||0})]}),e.jsxs(u,{form:d,className:"m-4",name:"basic",layout:"vertical",initialValues:{remember:!0,saleInvoiceNo:i,discount:0,paidAmount:[{}]},onFinish:s,onFinishFailed:y,autoComplete:"off",children:[e.jsx(u.Item,{label:"Date",rules:[{required:!0,message:"Please input the date!"}],style:{marginBottom:"10px"},children:e.jsx(Y,{onChange:p=>g(p==null?void 0:p._d),defaultValue:k(),label:"date",name:"date",rules:[{required:!0,message:"Please input Date"}]})}),e.jsx("span",{children:"Paid Amount"}),e.jsx(ce,{}),e.jsx(u.Item,{style:{marginBottom:"10px"},label:"Sale Invoice No",name:"saleInvoiceNo",validateStatus:"success",children:e.jsx(A,{disabled:!0})}),e.jsx(u.Item,{style:{marginBottom:"10px"},wrapperCol:{offset:8,span:16},children:e.jsx(O,{block:!0,type:"primary",htmlType:"submit",shape:"round",loading:l,children:"Pay Now"})})]})]})})},dt=it,ct=()=>{const t=K(),a=Z(),{pid:i}=ee(),{dueAmount:o}=a==null?void 0:a.state,n=N(),{Title:h}=ie,[d]=u.useForm();let[f,g]=c.useState(M());const[l,r]=c.useState(!1),s=async p=>{try{const P={date:f,purchaseInvoiceNo:parseInt(p.purchaseInvoiceNo),...p,paidAmount:p.paidAmount||[]};(await n(Me(P))).payload.message==="success"&&(r(!1),t(-1)),d.resetFields(),r(!1)}catch{r(!1)}},y=p=>{r(!1)};return e.jsx(e.Fragment,{children:e.jsx(Ne,{className:"mr-top",children:e.jsx(Ae,{xs:24,sm:24,md:12,lg:12,xl:14,className:"border rounded column-design",children:e.jsxs(te,{bordered:!1,className:"criclebox h-full",children:[e.jsx(h,{level:3,className:"m-3 text-center",children:"Purchase Invoice Payment"}),e.jsxs(h,{level:4,className:"text-center",children:["Due Amount : ",e.jsx("strong",{style:{color:"red"},children:o})]}),e.jsxs(u,{form:d,className:"m-4",name:"basic",layout:"vertical",initialValues:{remember:!0,purchaseInvoiceNo:i,paidAmount:[{}]},onFinish:s,onFinishFailed:y,autoComplete:"off",children:[e.jsx(u.Item,{label:"Date",required:!0,style:{marginBottom:"10px"},children:e.jsx(Y,{defaultValue:k(),onChange:p=>g(p==null?void 0:p._d),label:"date",name:"date",rules:[{required:!0,message:"Please input date!"}]})}),e.jsx("span",{children:"Paid Amount"}),e.jsx(ce,{}),e.jsx(u.Item,{style:{marginBottom:"10px"},label:"Purchase Invoice No",name:"purchaseInvoiceNo",children:e.jsx(A,{disabled:!0})}),e.jsx(u.Item,{style:{marginBottom:"10px"},wrapperCol:{offset:8,span:16},children:e.jsx(O,{block:!0,type:"primary",htmlType:"submit",shape:"round",loading:l,onClick:()=>r(!0),children:"Pay Now"})})]})]})})})})},mt=ct;function ut({isActive:t,id:a}){const i=N(),o=async(n,h)=>{let d=new FormData;d.append("isActive",n),d.append("_method","PUT"),(await i(se({values:d,id:h}))).payload.message==="success"&&i(T({status:"true",page:1,count:10}))};return e.jsx(Ke,{options:[{label:e.jsxs("span",{children:[e.jsx(ze,{})," Active"]}),value:"true"},{label:e.jsxs("span",{children:[e.jsx(st,{})," Inactive"]}),value:"false"}],value:t,onChange:n=>o(n,a)})}function pt({data:t}){const[a,i]=c.useState(!1),[o]=u.useForm(),n=N(),[h,d]=c.useState(!1),[f,g]=c.useState(""),[l,r]=c.useState([]),{list:s,loading:y}=I(b=>b.accounts),p=async b=>{try{let w=new FormData;t.id!==1&&(w.append("methodName",b.methodName),w.append("subAccountId",b.subAccountId),w.append("ownerAccount",b.ownerAccount),w.append("instruction",f)),w.append("_method","PUT"),w.append("images[]",l[0].originFileObj),(await n(se({values:w,id:t.id}))).payload.message==="success"&&(r([]),n(T({status:"true",page:1,count:10})),d(!1),x())}catch{d(!1)}},P=()=>{},m=()=>{i(!0)},x=()=>{i(!1)},S=({fileList:b})=>{r(b)};c.useEffect(()=>{s||n(H())},[n,s]);const $=b=>{g(b)},j=["header","font","size","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image","color","background"],v={toolbar:[[{header:"1"},{header:"2"},{font:[]}],[{list:"ordered"},{list:"bullet"}],["bold","italic","underline"],["link","image"],[{color:[]},{background:[]}],["clean"]]};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>{m()},children:[e.jsx(_e,{className:"bg-gray-600 p-1 text-white rounded-md"}),"Edit"]}),e.jsx(le,{title:"Update Payment Method",open:a,onCancel:x,footer:!1,children:e.jsx("div",{children:e.jsxs(u,{form:o,name:"basic",layout:"vertical",className:"sm:mx-10",onFinish:p,onFinishFailed:P,autoComplete:"off",initialValues:{...t},children:[t.id!==1&&e.jsxs(e.Fragment,{children:[" ",e.jsx(u.Item,{style:{marginBottom:"15px"},label:"Method Name",name:"methodName",rules:[{required:!0,message:"Please input method name!"}],children:e.jsx(A,{})}),e.jsx(u.Item,{style:{marginBottom:"15px"},label:"Owner Account",name:"ownerAccount",className:"w-full",rules:[{required:!0,message:"Please input owner account!"}],children:e.jsx(A,{})})," ",e.jsx(u.Item,{style:{marginBottom:"15px"},label:"Sub Account",name:"subAccountId",className:"w-full",rules:[{required:!0,message:"Please input sub account!"}],children:e.jsx(C,{name:"subAccountId",loading:y,showSearch:!0,placeholder:"Select Sub Account",optionFilterProp:"children",filterOption:(b,w)=>w.children.includes(b),filterSort:(b,w)=>b.children.toLowerCase().localeCompare(w.children.toLowerCase()),children:s&&s.map(b=>e.jsx(C.Option,{value:b.id,children:b.name},b.id))})})]}),e.jsx(u.Item,{label:"Upload Logo ",valuePropName:"Logo",required:!0,children:e.jsx(oe,{listType:"picture-card",beforeUpload:()=>!1,name:"image",fileList:l,maxCount:1,onChange:S,accept:"image/png, image/jpg, image/jpeg",children:e.jsxs("div",{children:[e.jsx(q,{}),e.jsx("div",{style:{marginTop:8},children:"Upload"})]})})}),t.id!==1&&e.jsx(u.Item,{style:{marginBottom:"15px"},label:"Instruction",name:"instruction",rules:[{required:!0,message:"Please input instruction !"}],children:e.jsx(re,{value:f,onChange:$,modules:v,formats:j})}),e.jsx(u.Item,{style:{marginBottom:"15px"},className:"flex justify-center mt-[24px]",children:e.jsx(O,{type:"primary",htmlType:"submit",shape:"round",loading:h,onClick:()=>{d(!0)},children:"Update payment Method"})})]})})})]})}function ht(){const t=N(),{list:a,total:i,loading:o}=I(l=>l.paymentMethod),[n,h]=c.useState({page:1,count:10,status:"true"}),d=l=>{l.target.src="/images/default.jpg"},f=[{id:1,title:"ID",dataIndex:"id",key:"id",width:"50px"},{id:2,title:"Logo",dataIndex:"logo",render:l=>e.jsx("div",{className:"w-[2.5rem] h-[2.5rem] relative p-1",children:e.jsx("img",{className:"absolute object-cover w-full h-full",alt:"product",onError:d,src:`https://posapi.zentrixtechnology.com//files/${l}`||"/images/default.jpg"})}),csvOff:!0,key:"image",width:"100px"},{id:3,title:"Sub Account",dataIndex:"subAccount",key:"subAccount",render:l=>l.name,renderCsv:l=>l.name},{id:4,title:"Payment Method",dataIndex:"methodName",key:"methodName"},{id:5,title:"Owner Account",dataIndex:"ownerAccount",key:"ownerAccount"},{id:6,title:"Instruction",dataIndex:"instruction",key:"instruction",render:l=>e.jsx("span",{dangerouslySetInnerHTML:{__html:Oe(l,20)}}),renderCsv:l=>l},{id:7,title:"Created At",dataIndex:"createdAt",key:"createdAt",render:l=>M(l).format("YYYY-MM-DD"),renderCsv:l=>M(l).format("DD/MM/YYYY")},{id:8,title:"Active",key:"isActive",render:({isActive:l,id:r})=>e.jsx(ut,{isActive:l,id:r}),csvOff:!0,width:"200px"},{id:4,title:"",key:"action",render:l=>[{label:e.jsx(R,{permission:"update-paymentMethod",children:e.jsx(pt,{data:l})}),key:"edit"},{label:e.jsx(Ue,{permission:"delete-paymentMethod",deleteThunk:$e,id:l.id,title:"Hide",loadThunk:T,query:{status:!0,page:1,count:10}}),key:"delete"}]}],g=[{key:"status",label:"Status",type:"select",options:[{label:"Show",value:"true"},{label:"Hide",value:"false"}],className:"min-w-[85px] max-w-[150px]",popupClassName:"w-[200px]"}];return c.useEffect(()=>{t(T(n))},[t,n]),e.jsx(U,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"Payment Methods",extra:e.jsx(ne,{permission:"create-paymentMethod",title:"Create Payment Method",width:35,children:e.jsx(de,{})}),children:e.jsx(R,{permission:"readAll-paymentMethod",children:e.jsx(ae,{total:i,columns:f,list:a,loading:o,setPageConfig:h,title:"Payment Method List",isSearch:!0,filters:g})})})}function _t(){return e.jsxs(De,{children:[e.jsx(D,{path:"/payment/supplier/:pid",exact:!0,element:e.jsx(F,{permission:"create-paymentPurchaseInvoice",children:e.jsx(mt,{})})}),e.jsx(D,{path:"/payment-report",element:e.jsx(F,{permission:"readAll-manualPayment",children:e.jsx(lt,{})})}),e.jsx(D,{path:"/payment/customer/:pid",exact:!0,element:e.jsx(F,{permission:"create-paymentSaleInvoice",children:e.jsx(dt,{})})})," ",e.jsx(D,{path:"/manual-payment",element:e.jsx(F,{permission:"readAll-manualPayment",children:e.jsx(rt,{})})}),e.jsx(D,{path:"/payment-method",element:e.jsx(F,{permission:"readAll-paymentMethod",children:e.jsx(ht,{})})})]})}export{_t as default};
